{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":""},{"location":"#deployment-cluster-with-s3-and-psql","title":"Deployment Cluster with S3 and psql","text":""},{"location":"#project-structure","title":"Project Structure","text":"<p>Here's an overview of the project structure </p> <pre><code>./\n\u251c\u2500\u2500 ansible/\n\u2502   \u251c\u2500\u2500 inventory/\n\u2502   \u2502   \u2514\u2500\u2500 hosts\n\u2502   \u251c\u2500\u2500 playbooks/\n\u2502   \u2502   \u251c\u2500\u2500 roles/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 common/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 minio/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 nginx/\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 postgresql/\n\u2502   \u2502   \u251c\u2500\u2500 templates_config/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 coolify_lb/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 minio_lb/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 scripts/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 ssl/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 playbook_install_python.yml\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 playbook_minio_preconfig.yml\n\u2502   \u2502   \u251c\u2500\u2500 playbook_install_coolify.yml\n\u2502   \u2502   \u251c\u2500\u2500 playbook_minio.yml\n\u2502   \u2502   \u251c\u2500\u2500 playbook_nginx_coolify_lb.yml\n\u2502   \u2502   \u251c\u2500\u2500 playbook_nginx_minio_lb.yml\n\u2502   \u2502   \u2514\u2500\u2500 playbook_psql.yml\n\u2502   \u251c\u2500\u2500 ansible.cfg\n\u2502   \u2514\u2500\u2500 requirements.yml\n\u2514\u2500\u2500 terraform-hetzner/\n    \u251c\u2500\u2500 db.tf\n    \u251c\u2500\u2500 load_balancer.tf\n    \u251c\u2500\u2500 main.tf\n    \u251c\u2500\u2500 minio.tf\n    \u251c\u2500\u2500 network.tf\n    \u251c\u2500\u2500 output.tf\n    \u251c\u2500\u2500 provider.tf\n    \u251c\u2500\u2500 ssh.tf\n    \u251c\u2500\u2500 terraform.tfstate\n    \u251c\u2500\u2500 terraform.tfstate.backup\n    \u2514\u2500\u2500 variabels.tf\n</code></pre>"},{"location":"create_infrastructure/","title":"Create infrastructure","text":"<p>Creating and configuring infrastructure processes depends on the resources you choose, and it will be explained in the playbook section</p>"},{"location":"create_infrastructure/#prerequisites","title":"Prerequisites","text":"<p>Before you begin, ensure you have the following:</p> <ul> <li>Hetzner Cloud account</li> <li>Terraform</li> <li>Ansible</li> </ul>"},{"location":"create_infrastructure/#deployment-steps","title":"Deployment Steps","text":""},{"location":"create_infrastructure/#1-generate-hetzner-api-token","title":"1. Generate Hetzner API Token","text":"<p>Create new project in Hetzner console</p> <p>Obtain API token from Hetzner console that will be used by Terraform to interact with the platform. Navigate to your project and click on SECURITY &gt; API TOKENS &gt; GENERATE API (give read/write access)</p> <p>Paste API token in the <code>.auto.tfvars</code>. This will overwrite default values in <code>variables.tf</code> file.</p>"},{"location":"create_infrastructure/#2-configure-infrastructure","title":"2. Configure infrastructure","text":"<p>Choose how many servers you want to have in your cluster, what type, which part of infrastructure you want to deploy, etc:</p> <pre><code>hcloud_token = \"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\"\n\nlocation_list     = [\"fsn1\", \"nbg1\", \"hel1\"]\n\ninstances_lb      = \"1\"\ninstances_minio_lb = \"1\"\ninstances_coolify_controler = \"1\"\ninstances_coolify_worker = \"4\"\ninstances_db      = \"1\"\ninstances_services = \"2\"\ninstances_minio   = \"4\"\n\nserver_type_coolify_controler = \"cx11\"\nserver_type_coolify_worker     = \"cx21\"\nserver_type_db       = \"cx41\"\nserver_type_services = \"cx21\"\nserver_type_minio    = \"cx21\"\n\nos_type        = \"ubuntu-22.04\"\ndisk_size      = \"10\"\nvolumes_per_node = \"4\"\npublic_net     = true\n</code></pre>"},{"location":"create_infrastructure/#3-initialize-and-apply-terraform","title":"3. Initialize and Apply Terraform","text":"<p>Initialize Terraform and apply the configuration:</p> <pre><code>cd hetzner-infra\nterraform init --upgrade\nterraform validate\nterraform apply -auto-approve\n</code></pre> <p>When Terraform finishes with infrastructure creation, you need the private and public server IPs. Public IPs are needed for setting up necessary installation and configuration with Ansible. Private IPs will be used by servers for communication and load balancing for distributing traffic. When the infrastructure is up and running, we can disable public IPs and the only entry point would be our load balancer.</p> <p>Terraform creates SSH private and public keys that are added to Hetzner and servers. They are also used by Ansible. Be careful with keys, you don't want to lose them.</p> <p>Terrafrom outputs:</p> <pre><code>server_ips = {\n  \"coolify_controler\" = {\n    \"coolify-controler-0\" = \"167.235.253.176\"\n  }\n  \"coolify_worker\" = {\n    \"coolify-worker-0\" = \"157.90.252.123\"\n    \"coolify-worker-1\" = \"168.119.165.118\"\n    \"coolify-worker-2\" = \"65.109.2.124\"\n    \"coolify-worker-3\" = \"49.13.126.247\"\n  }\n  \"minio\" = {\n    \"minio-0\" = \"91.107.198.134\"\n    \"minio-1\" = \"49.13.167.104\"\n    \"minio-2\" = \"65.109.141.80\"\n    \"minio-3\" = \"159.69.241.156\"\n  }\n  \"minio_lb\" = {\n    \"minio-lb-0\" = \"157.90.150.92\"\n  }\n  \"nginx_lb\" = {\n    \"nginx-lb-0\" = \"167.235.243.221\"\n  }\n  \"postgres_db\" = {\n    \"postgres-0\" = \"88.198.111.144\"\n  }\n  \"services\" = {\n    \"services-0\" = \"168.119.101.156\"\n    \"services-1\" = \"167.235.30.10\"\n  }\n}\nserver_status = {\n  \"coolify_controler\" = {\n    \"coolify-controler-0\" = \"running\"\n  }\n  \"coolify_worker\" = {\n    \"coolify-worker-0\" = \"running\"\n    \"coolify-worker-1\" = \"running\"\n    \"coolify-worker-2\" = \"running\"\n    \"coolify-worker-3\" = \"running\"\n  }\n  \"minio\" = {\n    \"minio-0\" = \"running\"\n    \"minio-1\" = \"running\"\n    \"minio-2\" = \"running\"\n    \"minio-3\" = \"running\"\n  }\n  \"minio_lb\" = {\n    \"minio-lb-0\" = \"running\"\n  }\n  \"nginx_lb\" = {\n    \"nginx-lb-0\" = \"running\"\n  }\n  \"postgres_db\" = {\n    \"postgres-0\" = \"running\"\n  }\n  \"services\" = {\n    \"services-0\" = \"running\"\n    \"services-1\" = \"running\"\n  }\n}\n</code></pre> <p>Reasurces: </p> <p>Subnets:  </p>"},{"location":"create_infrastructure/#4-configure-ansible-hosts","title":"4. Configure Ansible hosts","text":"<p>Add Ip addresses to the <code>hosts</code> file.</p> <pre><code>[coolify-controler]\n167.235.253.176\n\n[coolify-worker]\n157.90.252.123\n168.119.165.118\n65.109.2.124\n49.13.126.247\n\n[services]\n168.119.101.156\n167.235.30.10\n\n[db]\n88.198.111.144\n\n[minio]\n91.107.198.134\n49.13.167.104\n65.109.141.80\n159.69.241.156\n\n[nginx-minio-lb]\n157.90.150.92\n\n[nginx-lb]\n167.235.243.221\n</code></pre> <p>Now we are ready to configure individual playbooks and run them. This will install the required dependencies and configure our servers.</p>"},{"location":"create_infrastructure/#5-destroy-infrastructure","title":"5. Destroy infrastructure","text":"<p>To destroy the infrastructure run the following command:</p> <pre><code>terraform destroy -auto-approve\n</code></pre>"},{"location":"playbooks/coolify_playbook/","title":"Coolify","text":""},{"location":"playbooks/coolify_playbook/#coolify-container-workers-and-services-servers","title":"Coolify Container, Workers and Services servers","text":"<p>Infra for utilizing Hetzner low-cost VPS and Docker containers, wrapped in Coolify as an all-in-one PaaS, to self-host your own applications, databases, or services.</p>"},{"location":"playbooks/coolify_playbook/#1-configure-infrastructure","title":"1. Configure infrastructure","text":"<p>Choose how many servers you want to have in your cluster. For a minimum cluster in swarm mode, we need a controller, 3 workers, and a load balancer in front of the cluster. Servers that are part of services are also managed with Coolify controller. Read more about possible configurations and how to use Coolify in the official docs</p>"},{"location":"playbooks/coolify_playbook/#2-define-hosts-and-run-ansible-playbook","title":"2. Define hosts and run ansible playbook","text":"<p>In your <code>inventory/hosts</code> file, specify the IP addresses of your newly created servers obtained from Terraform output, or alternatively, verify them in the Hetzner Cloud console</p> <p>Run playbook:</p> <pre><code>cd ansible\nansible-playbook playbooks/playbook_install_coolify.yml \n</code></pre> <p>Ansible playbook automates the installation of Coolify on controller hosts. It configures common dependencies and enhances system security on both controller, workers and services hosts:</p> <ul> <li>Updates package lists and upgrades all packages to ensure the system is up to date.</li> <li>Installs necessary dependencies including UFW and Fail2Ban for enhancing system security.</li> <li>Sets up UFW to allow specific incoming traffic and enables it for added security.</li> <li>Configures Fail2Ban to prevent unauthorized access attempts by banning malicious IP addresses.</li> <li>Implements SSH hardening measures to secure remote access to the system.</li> <li>Installs Coolify on controller hosts and configures it to listen on specific ports.</li> <li>Configures worker hosts to allow incoming traffic on specified ports required for Coolify operation .</li> </ul>"},{"location":"playbooks/coolify_playbook/#3-open-ui","title":"3. Open UI:","text":"<p>When Ansible finishes, Coolify's UI will be available at: </p> <pre><code>CONTROLER_SERVER_IP:8000\n</code></pre> <p>Now is the time to configure Coolify. Add your private key that Terraform created, use workers private IPs and add the workers to your cluster. Consult the documentation for futher steps. </p>"},{"location":"playbooks/coolify_playbook/#4-ssh-into-server","title":"4. SSH into server","text":"<p>Terraform creates SSH private and public keys that are added to Hetzner and servers. They are also used by Ansible. Be careful with keys, you don't want to lose them.</p> <p>If needed, you can ssh into the server with the following command:</p> <pre><code>ssh root@&lt;server-ip&gt; -i ~/.ssh/self_hosted_hetzner_key.pem\n</code></pre>"},{"location":"playbooks/minio_playbook/","title":"MinIO","text":""},{"location":"playbooks/minio_playbook/#minio-s3-storage-playbook","title":"MinIO S3 storage playbook","text":"<p>MinIO is a High-Performance Object Storage system released under GNU Affero General Public License v3.0. It is API compatible with the Amazon S3 cloud storage service. In a Multi-Node Multi-Drive (MNMD) or \u201cDistributed\u201d configuration, provides enterprise-grade performance, availability, and scalability and are the recommended topology for all production workloads.</p> <p>MNMD deployments support erasure configurations which tolerate the loss of up to half the nodes or drives in the deployment while continuing to serve read operations.</p>"},{"location":"playbooks/minio_playbook/#1-configure-infrastructure","title":"1. Configure infrastructure","text":"<p>Choose how many servers you want to have in your cluster. It is recommended to have a minimum of 2 MinIO servers. In this example, we will use 4 servers distributed across all available locations. There are 3 locations in the EU: [\"fsn1\", \"nbg1\", \"hel1\"]. The number of servers and disks per VPS created will rotate around this list. Disks are auto-mounted, with a limit of 16 volumes per server.</p> <p>Load balancing (LB) is also needed to route requests automatically to nodes in the deployment. A multi-node setup eliminates a single point of failure. For best practices, check the MinIO documentation.</p>"},{"location":"playbooks/minio_playbook/#2-configure-minio-nginx-playbooks-and-hosts","title":"2. Configure Minio, Nginx playbooks and Hosts","text":"<p>In your <code>inventory/hosts</code> file, specify the IP addresses of your newly created servers obtained from Terraform output, or alternatively, verify them in the Hetzner Cloud console</p>"},{"location":"playbooks/minio_playbook/#a-minio-playbook-config","title":"a) MinIO playbook config","text":"<p>MinIO requires using expansion notation {x...y} to denote a sequential series of MinIO hosts and volumes when creating a server pool. Other variables are self explanatory:</p> <pre><code>vars:\n    minio_server_cluster_nodes:\n      [\n        \"https://minio{1...4}.ujstor.com:{{ minio_server_port }}/mnt/disk{1...4}/minio\",\n      ]\n\n    minio_server_port: \"9091\"\n    minio_console_port: \"9092\"\n\n    minio_root_user: \"ujstor\"\n    minio_root_password: \"roottoor123\"\n\n    minio_validate_certificate: true\n    minio_alias: \"ujstorminio\"\n</code></pre> <p>Another important aspect is defining the volumes per node that will have permissions for the MinIO user and group:</p> <pre><code>- name: Change ownership for /mnt/disk\n      become: true\n      become_user: root\n      ansible.builtin.file:\n        path: \"{{ item }}\"\n        owner: minio\n        group: minio\n        state: directory\n      with_items:\n        - /mnt/disk1\n        - /mnt/disk2\n        - /mnt/disk3\n        - /mnt/disk4\n</code></pre>"},{"location":"playbooks/minio_playbook/#b-preconfig-playbook-configuration","title":"b) Preconfig playbook configuration","text":"<p>In the <code>folder minio_config</code>, there is a preconfig playbook. This playbook will create DNS mappings, rename default volume names created by Hetzner, and copy certificates to every node.</p> <p>First, add hostnames and private IPs:</p> <pre><code>  vars:\n    dns_mappings:\n      - hostname: \"minio1.ujstor.com\"\n        ip_address: \"10.0.4.2\"\n      - hostname: \"minio2.ujstor.com\"\n        ip_address: \"10.0.4.3\"\n      - hostname: \"minio3.ujstor.com\"\n        ip_address: \"10.0.4.4\"\n      - hostname: \"minio4.ujstor.com\"\n        ip_address: \"10.0.4.5\"\n</code></pre> <p>Next, navigate to the SSL directory and create a certificate with this command:</p> <pre><code>sudo ./certgen-linux-amd64 -host \"10.0.4.2, 10.0.4.3, 10.0.4.4, 10.0.4.5, minio1.ujstor.com, minio2.ujstor.com, minio3.ujstor.com, minio4.ujstor.com\" &amp;&amp; sudo chmod 644 private.key\n</code></pre>"},{"location":"playbooks/minio_playbook/#c-configure-nginx-lb","title":"c) Configure Nginx lb","text":"<p>Nginx variables are pretty straightforward. You need private IPs from servers, ports for console and API defined in the MinIO playbook, and domains that you will register with your DNS provider.</p> <pre><code>  vars:\n    minio_servers:\n      - 10.0.4.2\n      - 10.0.4.3\n      - 10.0.4.4\n      - 10.0.4.5\n    minio_port: 9091\n    console_port: 9092\n    console_domain: minio-console.ujstor.com\n    minio_domain: minio.ujstor.com\n</code></pre> <p>When the playbook is applied, we will create certificates for secure SSL connections using Certbot for the chosen domains.</p>"},{"location":"playbooks/minio_playbook/#3-run-playbooks","title":"3. Run playbooks","text":"<p>MinIO:</p> <pre><code>cd ansible\nansible-playbook playbooks/playbook_minio.yml\n</code></pre> <p>Expected output:</p> <pre><code>PLAY RECAP ********************************************************************************************************\n128.140.0.112              : ok=46   changed=29   unreachable=0    failed=0    skipped=3    rescued=0    ignored=3\n135.181.88.205             : ok=46   changed=29   unreachable=0    failed=0    skipped=3    rescued=0    ignored=3\n49.13.73.3                 : ok=51   changed=31   unreachable=0    failed=0    skipped=7    rescued=0    ignored=3\n91.107.208.20              : ok=46   changed=29   unreachable=0    failed=0    skipped=3    rescued=0    ignored=3\n</code></pre> <p>Nginx:</p> <pre><code>ansible-playbook playbooks/playbook_nginx_minio_lb.yml\n</code></pre> <p>Expected output:</p> <pre><code>PLAY RECAP *******************************************************************************************************\n49.13.86.88                : ok=29   changed=18   unreachable=0    failed=0    skipped=9    rescued=0    ignored=0\n</code></pre> <p>Complete terminal output is available in the public directory.</p>"},{"location":"playbooks/minio_playbook/#4-ssh-into-lb-and-configure-ssl","title":"4. SSH into LB and configure ssl","text":"<p>Terraform creates SSH private and public keys that are added to Hetzner and servers. They are also used by Ansible. Be careful with keys, you don't want to lose them.</p> <p>SSH into LB with the following command:</p> <pre><code>ssh root@49.13.86.88 -i ~/.ssh/minio_hetzner_key.pem\n</code></pre> <p>Install snap and create cert:</p> <pre><code>apt install snapd\nsnap install --classic certbot\ncertbot --nginx\n</code></pre>"},{"location":"playbooks/minio_playbook/#5-open-ui-and-test-s3-compatable-api","title":"5. Open UI and test S3 compatable API","text":"<p>MinIO UI is now available at https://minio-console.ujstor.com. Once you configure buckets and permissions, test the API on https://minio.ujstor.com.</p>"},{"location":"playbooks/minio_playbook/#debugging","title":"Debugging","text":"<p>If there is an issue, you cant access the UI, SSH into one of the servers, and check the logs and systemctl status of the MinIO service</p> <pre><code>systemctl status minio.service\ncat /var/log/syslog\n</code></pre> <p>If you see something like this, there is a high chance that volume permissions are not set correctly or there was a problem with the volume rename:</p> <pre><code>root@minio-2:~# systemctl status minio.service\n\u25cf minio.service - MinIO\n     Loaded: loaded (/etc/systemd/system/minio.service; enabled; vendor preset: enabled)\n     Active: failed (Result: exit-code) since Thu 2024-03-14 22:13:37 UTC; 21min ago\n       Docs: https://docs.min.io\n    Process: 1062 ExecStartPre=/bin/bash -c if [ -z \"${MINIO_VOLUMES}\" ]; then echo \"Variable MINIO_VOLUMES not set in /etc/minio/minio.conf\"; exit 1; fi (code=exited, status=0/SUCCESS)\n    Process: 1063 ExecStart=/usr/local/bin/minio server $MINIO_OPTS $MINIO_VOLUMES (code=exited, status=1/FAILURE)\n   Main PID: 1063 (code=exited, status=1/FAILURE)\n\nMar 14 22:13:37 minio-2 systemd[1]: minio.service: Scheduled restart job, restart counter is at 5.\nMar 14 22:13:37 minio-2 systemd[1]: Stopped MinIO.\nMar 14 22:13:37 minio-2 systemd[1]: minio.service: Start request repeated too quickly.\nMar 14 22:13:37 minio-2 systemd[1]: minio.service: Failed with result 'exit-code'.\nMar 14 22:13:37 minio-2 systemd[1]: Failed to start MinIO.\n</code></pre> <p>Check /mnt/ to see if there are volumes named disk1-4. If they are present, run the MinIO playbook again from the 'Change ownership for /mnt/disk' task:</p> <pre><code>ansible-playbook playbooks/playbook_minio.yml --start-at-task=\"Change ownership for /mnt/disk\"\n</code></pre> <p>This command can be executed manually on every node if you SSH into them:</p> <pre><code>chown -R minio:minio /mnt/disk{1,2,3,4}\n</code></pre> <p>Other common things that can go wrong is DNS resolving, so check /etc/hosts to see if dns_mapping is correst:</p> <pre><code>cat /etc/hosts\n</code></pre> <p>Output:</p> <pre><code>cat /etc/hosts\n# Your system has configured 'manage_etc_hosts' as True.\n# As a result, if you wish for changes to this file to persist\n# then you will need to either\n# a.) make changes to the master file in /etc/cloud/templates/hosts.debian.tmpl\n# b.) change or remove the value of 'manage_etc_hosts' in\n#     /etc/cloud/cloud.cfg or cloud-config from user-data\n#\n127.0.1.1 minio-2 minio-2\n127.0.0.1 localhost\n\n# The following lines are desirable for IPv6 capable hosts\n::1 localhost ip6-localhost ip6-loopback\nff02::1 ip6-allnodes\nff02::2 ip6-allrouters\n\n10.0.4.2 minio1.ujstor.com\n10.0.4.3 minio2.ujstor.com\n10.0.4.4 minio3.ujstor.com\n10.0.4.5 minio4.ujstor.com\n</code></pre> <p>Let's assume that everything is working fine. You now have a login UI. Use the username and password defined in the Minio playbook. Congratulations! Your personal S3-compatible storage is up and running, ready to use.</p> <p> </p>"},{"location":"roles/minio/","title":"MinIO","text":"<p>Available variables are listed below along with default values (see <code>defaults\\main.yaml</code>)</p> <ul> <li>Wheter to install or not minio server and minio client</li> </ul> <pre><code>minio_install_server: true\nminio_install_client: true\n</code></pre> <ul> <li>Minio server installation details</li> </ul> <p>Minio UNIX user/group</p> <pre><code>minio_group: minio\nminio_user: minio\n</code></pre> <p>Minio installation directories to place server configuration (<code>minio_etc_dir</code>), TLS certificates (<code>minio_cert_dir</code>) and user access policies (<code>minio_policy_dir</code>)</p> <pre><code>minio_etc_dir: /etc/minio\nminio_cert_dir: \"{{ minio_etc_dir }}/ssl\"\nminio_policy_dir: \"{{ minio_etc_dir }}/policy\"\n</code></pre> <p>Minio server IP address (<code>minio_server_address</code>), if empty server listen in all available IP addresses, and server/console listening ports (<code>minio_server_port</code> and <code>minio_console_port</code>)</p> <pre><code>minio_server_port: \"9091\"\nminio_server_addr: \"\"\nminio_console_port: \"9092\"\n</code></pre> <p>Minio admin user and password</p> <pre><code>minio_root_user: \"\"\nminio_root_password: \"\"\n</code></pre> <p>Minio site region</p> <pre><code>minio_site_region: \"eu-west-1\"\n</code></pre> <p>Minio data directories (<code>minio_server_datadirs</code>) and whether force the creation in case they do not exist (<code>minio_server_make_datadirs</code>)</p> <pre><code>minio_server_make_datadirs: true\nminio_server_datadirs:\n- /var/lib/minio\n</code></pre> <pre><code>minio_server_cluster_nodes: []\n</code></pre> <p>Set a list of nodes to create a distributed cluster (Multi-Node Multi-Drive deployment).</p> <p>In this mode, ansible will create your server datadirs (<code>minio_serverdata_dirs</code>), but use this list (<code>minio_server_cluster_nodes</code>) for the server startup.</p> <p>Multi-drive configuration requires datadirs on separate disks to satisfy Minio's distributed storage requirements.</p> <p>See recommendations for using, same configuration in all nodes, sequential hostnames and local-atached storage with sequential mounts in the documentation (https://min.io/docs/minio/linux/operations/install-deploy-manage/deploy-minio-multi-node-multi-drive.html)</p> <p>Example:</p> <pre><code>minio_server_datadirs:\n- '/mnt/disk1/minio'\n- '/mnt/disk2/minio'\n- '/mnt/disk3/minio'\n- '/mnt/disk4/minio'\nminio_server_cluster_nodes:\n- 'https://minio{1...4}.example.net:9091/mnt/disk{1...4}/minio'\n</code></pre> <ul> <li>Minio client configuration</li> </ul> <p>Connection alias name <code>minio_alias</code> and whether validate or not SSL certificates (<code>minio_validate_certificates</code>)</p> <pre><code>minio_validate_certificate: true\nminio_alias: \"myminio\"\n</code></pre> <ul> <li>Configuration of TLS</li> </ul> <p>To enable configuration of TLS set <code>minio_enable_tls</code> to true and provide the private key and public certificate as content loaded into <code>minio_key</code> and <code>minio_cert</code> variables.</p> <p>They can be loaded from files using an ansible task like:</p> <pre><code>- name: Load tls key and cert from files\nset_fact:\nminio_key: \"{{ lookup('file','certificates/{{ inventory_hostname }}_private.key') }}\"\nminio_cert: \"{{ lookup('file','certificates/{{ inventory_hostname }}_public.crt') }}\"\n\n</code></pre> <p><code>minio_url</code> might be needed in case MinIO Server TLS certificates do not contain any IP Subject Alternative Names (SAN). See MINIO_SERVER_URL environment variable definition.</p> <pre><code>minio_url: \"https://minio.test.com:{{ minio_server_port }}\"\n</code></pre> <ul> <li>Buckets to be created</li> </ul> <p>Variable <code>minio_buckets</code> create the list of provided buckets, and applying a specifc policy. For creating the buckets, a modified version of Ansible Module from Alexis Facques is used (https://github.com/alexisfacques/ansible-module-s3-minio-bucket)</p> <pre><code>minio_buckets:\n- name: bucket1\n    policy: read-only\n- name: bucket2\n    policy: read-write\n- name: bucket3\n    policy: private\n</code></pre> <p>NOTE The module use remote connection to Minio Server using Python API (<code>minio</code> python package). Role ensure that PIP is installed and install <code>minio</code> package.</p> <p>During bucket creation three types of policy can be specified: <code>private</code>, <code>read-only</code> or <code>read-write</code> buckets.</p> <ul> <li>Users to be created and buckets ACLs</li> </ul> <p>Users can be automatically created using  <code>minio_users</code> variable: a list of users can be provided, each user with three variables <code>name</code> (user name), <code>password</code> (user password) and <code>buckets_acl</code> list of buckets and type of access granted to each bucket (read-only or read-write). The role automatically create policy json files containing the user policy statements and load them into the server.</p> <p>Predefined <code>read-only</code> and <code>read-write</code> policies, containing pre-defined access statements, can be used. Custom policies can be also defined using  <code>custom</code> policy. In this case list of access statements need to be provided.</p> <pre><code>minio_users:\n- name: user1\npassword: supers1cret0\nbuckets_acl:\n    - name: bucket1\n    policy: read-write\n    - name: bucket2\n    policy: read-only\n    - name: bucket3\n    policy: custom\n    custom:\n        - rule: |\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"s3:GetObject\",\n                \"s3:DeleteObject\",\n                \"s3:PutObject\",\n                \"s3:AbortMultipartUpload\",\n                \"s3:ListMultipartUploadParts\"\n            ],\n            \"Resource\": [\n                \"arn:aws:s3:::bucket3/*\"\n            ]\n        - rule: |\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"s3:ListBucket\"\n            ],\n            \"Resource\": [\n                \"arn:aws:s3:::bucket3\"\n            ]\n</code></pre> <p>The previous configuration will create the following policy.json file for the user</p> <pre><code>{\n\"Version\": \"2012-10-17\",\n\"Statement\": [\n    {\n        \"Effect\": \"Allow\",\n        \"Action\": [\n            \"s3:DeleteObject\",\n            \"s3:GetObject\",\n            \"s3:ListBucket\",\n            \"s3:PutObject\"\n        ],\n        \"Resource\": [\n            \"arn:aws:s3:::bucket1\",\n            \"arn:aws:s3:::bucket1/*\"\n        ]\n    },\n    {\n        \"Effect\": \"Allow\",\n        \"Action\": [\n            \"s3:GetObject\",\n            \"s3:ListBucket\"\n        ],\n        \"Resource\": [\n            \"arn:aws:s3:::bucket2\",\n            \"arn:aws:s3:::bucket2/*\"\n        ]\n    },\n    {\n        \"Effect\": \"Allow\",\n        \"Action\": [\n            \"s3:AbortMultipartUpload\",\n            \"s3:DeleteObject\",\n            \"s3:GetObject\",\n            \"s3:ListMultipartUploadParts\",\n            \"s3:PutObject\"\n        ],\n        \"Resource\": [\n            \"arn:aws:s3:::bucket3/*\"\n        ]\n    },\n    {\n        \"Effect\": \"Allow\",\n        \"Action\": [\n            \"s3:ListBucket\"\n        ],\n        \"Resource\": [\n            \"arn:aws:s3:::bucket3\"\n        ]\n    }\n]\n}\n</code></pre> <ul> <li>Generate Prometheus bearer token</li> </ul> <pre><code>minio_prometheus_bearer_token: false\nprometheus_bearer_token_output: \"{{ minio_etc_dir }}/prometheus_bearer.json\"\n</code></pre> <p>Setting <code>minio_prometheus_bearer_token</code> to true, generates a file <code>/etc/minio/prometheus_bearer.json</code> which contains the result of executing the command:</p> <p><code>mc admin prometheus generate myminio -json</code></p>"},{"location":"roles/minio/#example-playbook","title":"Example Playbook","text":"<p>The following playbook install and configure minio server and client, enabling TLS and generating self-signed SSL certificates. It also create some buckets and users with proper ACLs</p> <pre><code>---\n- name: Install and configure Minio Server\nhosts: minio\nbecome: true\ngather_facts: true\nvars:\nserver_hostname: minio.example.com\nssl_key_size: 4096\nssl_certificate_provider: selfsigned\n\npre_tasks:\n- name: Generate self-signed SSL certificates for minio\n    include_tasks: generate_selfsigned_cert.yml\n    args:\n    apply:\n        delegate_to: localhost\n        become: false\n- name: Load tls key and cert\n    set_fact:\n    minio_key: \"{{ lookup('file','certificates/' + inventory_hostname + '_private.key') }}\"\n    minio_cert: \"{{ lookup('file','certificates/' + inventory_hostname + '_public.crt') }}\"\n\nroles:\n- role: minio\n    minio_root_user: \"miniadmin\"\n    minio_root_password: \"supers1cret0\"\n    minio_enable_tls: true\n    minio_url: \"https://{{ server_hostname }}:{{ minio_server_port }}\"\n    minio_buckets:\n    - name: bucket1\n        policy: read-write\n    - name: bucket2\n        policy: read-write\n    minio_users:\n    - name: user1\n        password: supers1cret0\n        buckets_acl:\n        - name: bucket1\n            policy: read-write\n        - name: bucket2\n            policy: read-only\n\n</code></pre> <p><code>pre-tasks</code> section include tasks to generate a private key and a self-signed certificate and load them into <code>minio_key</code> and <code>minio_cert</code> variables.</p> <p>Where <code>generate_selfsigned_cert.yml</code> contain the tasks for generating a Private Key and SSL self-signed certificate:</p> <pre><code>---\n- name: Create private certificate\nopenssl_privatekey:\npath: \"certificates/{{ inventory_hostname }}_private.key\"\nsize: \"{{ ssl_key_size | int }}\"\nmode: 0644\n\n- name: Create CSR\nopenssl_csr:\npath: \"certificates/{{ inventory_hostname }}_cert.csr\"\nprivatekey_path: \"certificates/{{ inventory_hostname }}_private.key\"\ncommon_name: \"{{ server_hostname }}\"\n\n- name: Create certificates for keystore\nopenssl_certificate:\ncsr_path: \"certificates/{{ inventory_hostname }}_cert.csr\"\npath: \"certificates/{{ inventory_hostname }}_public.crt\"\nprivatekey_path: \"certificates/{{ inventory_hostname }}_private.key\"\nprovider: \"{{ ssl_certificate_provider }}\"\n\n</code></pre>"},{"location":"roles/nginx/","title":"Nginx","text":"<p>Available variables are listed below, along with default values (see <code>defaults/main.yml</code>):</p> <pre><code>nginx_listen_ipv6: true\n</code></pre> <p>Whether or not to listen on IPv6 (applied to all vhosts managed by this role).</p> <pre><code>nginx_vhosts: []\n</code></pre> <p>A list of vhost definitions (server blocks) for Nginx virtual hosts. Each entry will create a separate config file named by <code>server_name</code>. If left empty, you will need to supply your own virtual host configuration. See the commented example in <code>defaults/main.yml</code> for available server options. If you have a large number of customizations required for your server definition(s), you're likely better off managing the vhost configuration file yourself, leaving this variable set to <code>[]</code>.</p> <pre><code>nginx_vhosts:\n  - listen: \"443 ssl http2\"\n    server_name: \"example.com\"\n    server_name_redirect: \"www.example.com\"\n    root: \"/var/www/example.com\"\n    index: \"index.php index.html index.htm\"\n    error_page: \"\"\n    access_log: \"\"\n    error_log: \"\"\n    state: \"present\"\n    template: \"{{ nginx_vhost_template }}\"\n    filename: \"example.com.conf\"\n    extra_parameters: |\n      location ~ \\.php$ {\n          fastcgi_split_path_info ^(.+\\.php)(/.+)$;\n          fastcgi_pass unix:/var/run/php5-fpm.sock;\n          fastcgi_index index.php;\n          fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n          include fastcgi_params;\n      }\n      ssl_certificate     /etc/ssl/certs/ssl-cert-snakeoil.pem;\n      ssl_certificate_key /etc/ssl/private/ssl-cert-snakeoil.key;\n      ssl_protocols       TLSv1.1 TLSv1.2;\n      ssl_ciphers         HIGH:!aNULL:!MD5;\n</code></pre> <p>An example of a fully-populated nginx_vhosts entry, using a <code>|</code> to declare a block of syntax for the <code>extra_parameters</code>.</p> <p>Please take note of the indentation in the above block. The first line should be a normal 2-space indent. All other lines should be indented normally relative to that line. In the generated file, the entire block will be 4-space indented. This style will ensure the config file is indented correctly.</p> <pre><code>  - listen: \"80\"\n    server_name: \"example.com www.example.com\"\n    return: \"301 https://example.com$request_uri\"\n    filename: \"example.com.80.conf\"\n</code></pre> <p>An example of a secondary vhost which will redirect to the one shown above.</p> <p>Note: The <code>filename</code> defaults to the first domain in <code>server_name</code>, if you have two vhosts with the same domain, eg. a redirect, you need to manually set the <code>filename</code> so the second one doesn't override the first one</p> <pre><code>nginx_remove_default_vhost: false\n</code></pre> <p>Whether to remove the 'default' virtualhost configuration supplied by Nginx. Useful if you want the base <code>/</code> URL to be directed at one of your own virtual hosts configured in a separate .conf file.</p> <pre><code>nginx_upstreams: []\n</code></pre> <p>If you are configuring Nginx as a load balancer, you can define one or more upstream sets using this variable. In addition to defining at least one upstream, you would need to configure one of your server blocks to proxy requests through the defined upstream (e.g. <code>proxy_pass http://myapp1;</code>). See the commented example in <code>defaults/main.yml</code> for more information.</p> <pre><code>nginx_user: \"nginx\"\n</code></pre> <p>The user under which Nginx will run. Defaults to <code>nginx</code> for RedHat, <code>www-data</code> for Debian and <code>www</code> on FreeBSD and OpenBSD.</p> <pre><code>nginx_worker_processes: \"{{ ansible_processor_vcpus|default(ansible_processor_count) }}\"\nnginx_worker_connections: \"1024\"\nnginx_multi_accept: \"off\"\n</code></pre> <p><code>nginx_worker_processes</code> should be set to the number of cores present on your machine (if the default is incorrect, find this number with <code>grep processor /proc/cpuinfo | wc -l</code>). <code>nginx_worker_connections</code> is the number of connections per process. Set this higher to handle more simultaneous connections (and remember that a connection will be used for as long as the keepalive timeout duration for every client!). You can set <code>nginx_multi_accept</code> to <code>on</code> if you want Nginx to accept all connections immediately.</p> <pre><code>nginx_error_log: \"/var/log/nginx/error.log warn\"\nnginx_access_log: \"/var/log/nginx/access.log main buffer=16k flush=2m\"\n</code></pre> <p>Configuration of the default error and access logs. Set to <code>off</code> to disable a log entirely.</p> <pre><code>nginx_sendfile: \"on\"\nnginx_tcp_nopush: \"on\"\nnginx_tcp_nodelay: \"on\"\n</code></pre> <p>TCP connection options. See this blog post for more information on these directives.</p> <pre><code>nginx_keepalive_timeout: \"65\"\nnginx_keepalive_requests: \"100\"\n</code></pre> <p>Nginx keepalive settings. Timeout should be set higher (10s+) if you have more polling-style traffic (AJAX-powered sites especially), or lower (&lt;10s) if you have a site where most users visit a few pages and don't send any further requests.</p> <pre><code>nginx_server_tokens: \"on\"\n</code></pre> <p>Nginx server_tokens settings. Controls whether nginx responds with it's version in HTTP headers. Set to <code>\"off\"</code> to disable.</p> <pre><code>nginx_client_max_body_size: \"64m\"\n</code></pre> <p>This value determines the largest file upload possible, as uploads are passed through Nginx before hitting a backend like <code>php-fpm</code>. If you get an error like <code>client intended to send too large body</code>, it means this value is set too low.</p> <pre><code>nginx_server_names_hash_bucket_size: \"64\"\n</code></pre> <p>If you have many server names, or have very long server names, you might get an Nginx error on startup requiring this value to be increased.</p> <pre><code>nginx_proxy_cache_path: \"\"\n</code></pre> <p>Set as the <code>proxy_cache_path</code> directive in the <code>nginx.conf</code> file. By default, this will not be configured (if left as an empty string), but if you wish to use Nginx as a reverse proxy, you can set this to a valid value (e.g. <code>\"/var/cache/nginx keys_zone=cache:32m\"</code>) to use Nginx's cache (further proxy configuration can be done in individual server configurations).</p> <pre><code>nginx_extra_http_options: \"\"\n</code></pre> <p>Extra lines to be inserted in the top-level <code>http</code> block in <code>nginx.conf</code>. The value should be defined literally (as you would insert it directly in the <code>nginx.conf</code>, adhering to the Nginx configuration syntax - such as <code>;</code> for line termination, etc.), for example:</p> <pre><code>nginx_extra_http_options: |\n  proxy_buffering    off;\n  proxy_set_header   X-Real-IP $remote_addr;\n  proxy_set_header   X-Scheme $scheme;\n  proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;\n  proxy_set_header   Host $http_host;\n</code></pre> <p>See the template in <code>templates/nginx.conf.j2</code> for more details on the placement.</p> <pre><code>nginx_extra_conf_options: \"\"\n</code></pre> <p>Extra lines to be inserted in the top of <code>nginx.conf</code>. The value should be defined literally (as you would insert it directly in the <code>nginx.conf</code>, adhering to the Nginx configuration syntax - such as <code>;</code> for line termination, etc.), for example:</p> <pre><code>nginx_extra_conf_options: |\n  worker_rlimit_nofile 8192;\n</code></pre> <p>See the template in <code>templates/nginx.conf.j2</code> for more details on the placement.</p> <pre><code>nginx_log_format: |-\n  '$remote_addr - $remote_user [$time_local] \"$request\" '\n  '$status $body_bytes_sent \"$http_referer\" '\n  '\"$http_user_agent\" \"$http_x_forwarded_for\"'\n</code></pre> <p>Configures Nginx's <code>log_format</code>. options.</p> <pre><code>nginx_default_release: \"\"\n</code></pre> <p>(For Debian/Ubuntu only) Allows you to set a different repository for the installation of Nginx. As an example, if you are running Debian's wheezy release, and want to get a newer version of Nginx, you can install the <code>wheezy-backports</code> repository and set that value here, and Ansible will use that as the <code>-t</code> option while installing Nginx.</p> <pre><code>nginx_ppa_use: false\nnginx_ppa_version: stable\n</code></pre> <p>(For Ubuntu only) Allows you to use the official Nginx PPA instead of the system's package. You can set the version to <code>stable</code> or <code>development</code>.</p> <pre><code>nginx_yum_repo_enabled: true\n</code></pre> <p>(For RedHat/CentOS only) Set this to <code>false</code> to disable the installation of the <code>nginx</code> yum repository. This could be necessary if you want the default OS stable packages, or if you use Satellite.</p> <pre><code>nginx_service_state: started\nnginx_service_enabled: yes\n</code></pre> <p>By default, this role will ensure Nginx is running and enabled at boot after Nginx is configured. You can use these variables to override this behavior if installing in a container or further control over the service state is required.</p>"},{"location":"roles/nginx/#overriding-configuration-templates","title":"Overriding configuration templates","text":"<p>If you can't customize via variables because an option isn't exposed, you can override the template used to generate the virtualhost configuration files or the <code>nginx.conf</code> file.</p> <pre><code>nginx_conf_template: \"nginx.conf.j2\"\nnginx_vhost_template: \"vhost.j2\"\n</code></pre> <p>If necessary you can also set the template on a per vhost basis.</p> <pre><code>nginx_vhosts:\n  - listen: \"80 default_server\"\n    server_name: \"site1.example.com\"\n    root: \"/var/www/site1.example.com\"\n    index: \"index.php index.html index.htm\"\n    template: \"{{ playbook_dir }}/templates/site1.example.com.vhost.j2\"\n  - server_name: \"site2.example.com\"\n    root: \"/var/www/site2.example.com\"\n    index: \"index.php index.html index.htm\"\n    template: \"{{ playbook_dir }}/templates/site2.example.com.vhost.j2\"\n</code></pre> <p>You can either copy and modify the provided template, or extend it with Jinja2 template inheritance and override the specific template block you need to change.</p>"},{"location":"roles/nginx/#example-configure-gzip-in-nginx-configuration","title":"Example: Configure gzip in nginx configuration","text":"<p>Set the <code>nginx_conf_template</code> to point to a template file in your playbook directory.</p> <pre><code>nginx_conf_template: \"{{ playbook_dir }}/templates/nginx.conf.j2\"\n</code></pre> <p>Create the child template in the path you configured above and extend <code>nginx</code> template file relative to your <code>playbook.yml</code>.</p> <pre><code>{% extends 'roles/nginx/templates/nginx.conf.j2' %}\n\n{% block http_gzip %}\n    gzip on;\n    gzip_proxied any;\n    gzip_static on;\n    gzip_http_version 1.0;\n    gzip_disable \"MSIE [1-6]\\.\";\n    gzip_vary on;\n    gzip_comp_level 6;\n    gzip_types\n        text/plain\n        text/css\n        text/xml\n        text/javascript\n        application/javascript\n        application/x-javascript\n        application/json\n        application/xml\n        application/xml+rss\n        application/xhtml+xml\n        application/x-font-ttf\n        application/x-font-opentype\n        image/svg+xml\n        image/x-icon;\n    gzip_buffers 16 8k;\n    gzip_min_length 512;\n{% endblock %}\n</code></pre>"},{"location":"roles/nginx/#example-playbook","title":"Example Playbook","text":"<pre><code>- hosts: server\n  roles:\n    - { role: nginx }\n</code></pre>"},{"location":"roles/psql/","title":"Psql","text":""},{"location":"roles/psql/#example-playbook","title":"Example Playbook","text":"<pre><code>---\nhosts: db\n  become: yes\n  vars:\n    postgresql_version: 16\n    postgresql_listen_addresses: \"*\"\n\n    postgresql_databases:\n      - name: blueprint\n        owner: ujstor\n        state: \"present\"\n\n    postgresql_users:\n      - name: ujstor\n        pass: password1234\n        encrypted: yes\n        state: \"present\"\n\n    postgresql_database_schemas:\n      - database: blueprint\n        schema: ujstor-test\n        state: present\n\n    postgresql_user_privileges:\n      - name: ujstor\n        db: blueprint\n        role_attr_flags: \"SUPERUSER\"\n\n  roles:\n    - role: common\n    - role: postgresql\n</code></pre>"},{"location":"roles/psql/#variables","title":"Variables","text":"<pre><code># Basic settings\npostgresql_version: 16\npostgresql_encoding: \"UTF-8\"\npostgresql_locale: \"en_US.UTF-8\"\npostgresql_ctype: \"en_US.UTF-8\"\n\npostgresql_admin_user: \"postgres\"\npostgresql_default_auth_method: \"peer\"\n\npostgresql_cluster_name: main\npostgresql_cluster_reset: false\n\n# List of databases to be created (optional)\n# Note: for more flexibility with extensions use the postgresql_database_extensions setting.\npostgresql_databases:\n  - name: foobar\n    owner: baz # optional; specify the owner of the database\n    hstore: yes # flag to install the hstore extension on this database (yes/no)\n    uuid_ossp: yes # flag to install the uuid-ossp extension on this database (yes/no)\n    citext: yes # flag to install the citext extension on this database (yes/no)\n    encoding: \"UTF-8\" # override global {{ postgresql_encoding }} variable per database\n    state: \"present\" # optional; one of 'present', 'absent', 'dump', 'restore'\n    lc_collate: \"en_GB.UTF-8\" # override global {{ postgresql_locale }} variable per database\n    lc_ctype: \"en_GB.UTF-8\" # override global {{ postgresql_ctype }} variable per database\n\n# List of database extensions to be created (optional)\npostgresql_database_extensions:\n  - db: foobar\n    extensions:\n      - hstore\n      - citext\n\n# List of users to be created (optional)\npostgresql_users:\n  - name: baz\n    pass: pass\n    encrypted: yes # if password should be encrypted, postgresql &gt;= 10 does only accepts encrypted passwords\n    state: \"present\" # optional; one of 'present', 'absent'\n\n# List of schemas to be created (optional)\npostgresql_database_schemas:\n  - database: foobar # database name\n    schema: acme # schema name\n    state: present\n\n  - database: foobar # database name\n    schema: acme_baz # schema name\n    owner: baz # owner name\n    state: present\n\n# List of user privileges to be applied (optional)\npostgresql_user_privileges:\n  - name: baz # user name\n    db: foobar # database\n    priv: \"ALL\" # privilege string format: example: INSERT,UPDATE/table:SELECT/anothertable:ALL\n    role_attr_flags: \"CREATEDB\" # role attribute flags\n</code></pre> <p>There's a lot more options to set, which you can find in <code>defaults/main.yml</code></p>"},{"location":"terminal/coolify_ansible/","title":"Coolify","text":"<pre><code>ansible-playbook playbooks/playbook_install_coolify.yml\n\nPLAY [Install Coolify on controler host] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************\n\nTASK [Gathering Facts] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [167.235.253.176]\n\nTASK [common : Update package lists] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [167.235.253.176]\n\nTASK [common : Upgrade all packages] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [167.235.253.176]\n\nTASK [common : Install public AuthorizedKeysFile] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [167.235.253.176]\n\nTASK [common : Install required packages] *************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [167.235.253.176]\n\nTASK [common : Allow everything and enable UFW] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [167.235.253.176]\n\nTASK [common : Allow incoming traffic on specified ports] *********************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [167.235.253.176] =&gt; (item=22)\n\nTASK [common : Configure Fail2Ban] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [167.235.253.176]\n\nTASK [common : Restart fail2ban] **********************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [167.235.253.176]\n\nTASK [common : SSH Hardening for root user] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [167.235.253.176]\n\nTASK [common : Restart sshd] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [167.235.253.176]\n\nTASK [Allow incoming UI Port] *************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [167.235.253.176] =&gt; (item=6001)\nchanged: [167.235.253.176] =&gt; (item=8000)\nchanged: [167.235.253.176] =&gt; (item=80)\nchanged: [167.235.253.176] =&gt; (item=443)\n\nTASK [Download Coolify installation script] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [167.235.253.176]\n\nTASK [Execute Coolify installation script] ************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [167.235.253.176]\n\nTASK [Debug installation script output] ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [167.235.253.176] =&gt; {\n    \"install_result.stdout_lines\": [\n        \"-------------\",\n        \"Welcome to Coolify v4 beta installer!\",\n        \"This script will install everything for you.\",\n        \"(Source code: https://github.com/coollabsio/coolify/blob/main/scripts/install.sh)\",\n        \"\",\n        \"-------------\",\n        \"OS: ubuntu 22.04\",\n        \"Coolify version: 4.0.0-beta.239\",\n        \"-------------\",\n        \"Installing required packages...\",\n        \"OpenSSH server is installed.\",\n        \"OpenSSH server is installed.\",\n        \"PermitRootLogin is enabled.\",\n        \"Docker is not installed. Installing Docker.\",\n        \"# Executing docker install script, commit: e5543d473431b782227f8908005543bb4389b8de\",\n        \"INFO: Searching repository for VERSION '24.0.7'\",\n        \"INFO: apt-cache madison docker-ce | grep '24.0.7' | head -1 | awk '{$1=$1};1' | cut -d' ' -f 3\",\n        \"INFO: apt-cache madison docker-ce-cli | grep '24.0.7' | head -1 | awk '{$1=$1};1' | cut -d' ' -f 3\",\n        \"Client: Docker Engine - Community\",\n        \" Version:           24.0.7\",\n        \" API version:       1.43\",\n        \" Go version:        go1.20.10\",\n        \" Git commit:        afdd53b\",\n        \" Built:             Thu Oct 26 09:07:41 2023\",\n        \" OS/Arch:           linux/amd64\",\n        \" Context:           default\",\n        \"\",\n        \"Server: Docker Engine - Community\",\n        \" Engine:\",\n        \"  Version:          24.0.7\",\n        \"  API version:      1.43 (minimum version 1.12)\",\n        \"  Go version:       go1.20.10\",\n        \"  Git commit:       311b9ff\",\n        \"  Built:            Thu Oct 26 09:07:41 2023\",\n        \"  OS/Arch:          linux/amd64\",\n        \"  Experimental:     false\",\n        \" containerd:\",\n        \"  Version:          1.6.28\",\n        \"  GitCommit:        ae07eda36dd25f8a1b98dfbf587313b99c0190bb\",\n        \" runc:\",\n        \"  Version:          1.1.12\",\n        \"  GitCommit:        v1.1.12-0-g51d5e94\",\n        \" docker-init:\",\n        \"  Version:          0.19.0\",\n        \"  GitCommit:        de40ad0\",\n        \"\",\n        \"================================================================================\",\n        \"\",\n        \"To run Docker as a non-privileged user, consider setting up the\",\n        \"Docker daemon in rootless mode for your user:\",\n        \"\",\n        \"    dockerd-rootless-setuptool.sh install\",\n        \"\",\n        \"Visit https://docs.docker.com/go/rootless/ to learn about rootless mode.\",\n        \"\",\n        \"\",\n        \"To run the Docker daemon as a fully privileged service, but granting non-root\",\n        \"users access, refer to https://docs.docker.com/go/daemon-access/\",\n        \"\",\n        \"WARNING: Access to the remote API on a privileged Docker daemon is equivalent\",\n        \"         to root access on the host. Refer to the 'Docker daemon attack surface'\",\n        \"         documentation for details: https://docs.docker.com/go/attack-surface/\",\n        \"\",\n        \"================================================================================\",\n        \"\",\n        \"Docker installed successfully.\",\n        \"-------------\",\n        \"Check Docker Configuration...\",\n        \"Docker configuration updated, restart docker daemon...\",\n        \"-------------\",\n        \"Downloading required files from CDN...\",\n        \"541647d15e1fce004930b5b3eed78c9971648e48924b3e601d730325a942db60\",\n        \"\",\n        \"Congratulations! Your Coolify instance is ready to use.\",\n        \"\",\n        \"Please visit http://167.235.253.176:8000 to get started.\"\n    ]\n}\n\nPLAY [Worker configuration] ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\n\nTASK [Gathering Facts] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [157.90.252.123]\nok: [168.119.165.118]\nok: [168.119.101.156]\nok: [49.13.126.247]\nok: [65.109.2.124]\nok: [167.235.30.10]\n\nTASK [common : Update package lists] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [157.90.252.123]\nchanged: [168.119.101.156]\nchanged: [49.13.126.247]\nchanged: [65.109.2.124]\nchanged: [168.119.165.118]\nchanged: [167.235.30.10]\n\nTASK [common : Upgrade all packages] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [49.13.126.247]\nchanged: [168.119.101.156]\nchanged: [65.109.2.124]\nchanged: [157.90.252.123]\nchanged: [168.119.165.118]\nchanged: [167.235.30.10]\n\nTASK [common : Install public AuthorizedKeysFile] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [157.90.252.123]\nchanged: [49.13.126.247]\nchanged: [168.119.101.156]\nchanged: [168.119.165.118]\nchanged: [65.109.2.124]\nchanged: [167.235.30.10]\n\nTASK [common : Install required packages] *************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [157.90.252.123]\nchanged: [168.119.101.156]\nchanged: [49.13.126.247]\nchanged: [65.109.2.124]\nchanged: [168.119.165.118]\nchanged: [167.235.30.10]\n\nTASK [common : Allow everything and enable UFW] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [49.13.126.247]\nchanged: [168.119.101.156]\nchanged: [168.119.165.118]\nchanged: [65.109.2.124]\nchanged: [157.90.252.123]\nchanged: [167.235.30.10]\n\nTASK [common : Allow incoming traffic on specified ports] *********************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [49.13.126.247] =&gt; (item=22)\nchanged: [157.90.252.123] =&gt; (item=22)\nchanged: [168.119.101.156] =&gt; (item=22)\nchanged: [168.119.165.118] =&gt; (item=22)\nchanged: [65.109.2.124] =&gt; (item=22)\nchanged: [167.235.30.10] =&gt; (item=22)\n\nTASK [common : Configure Fail2Ban] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [168.119.165.118]\nchanged: [49.13.126.247]\nchanged: [157.90.252.123]\nchanged: [168.119.101.156]\nchanged: [65.109.2.124]\nchanged: [167.235.30.10]\n\nTASK [common : Restart fail2ban] **********************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [157.90.252.123]\nchanged: [168.119.165.118]\nchanged: [168.119.101.156]\nchanged: [49.13.126.247]\nchanged: [65.109.2.124]\nchanged: [167.235.30.10]\n\nTASK [common : SSH Hardening for root user] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [157.90.252.123]\nchanged: [168.119.165.118]\nchanged: [49.13.126.247]\nchanged: [168.119.101.156]\nchanged: [65.109.2.124]\nchanged: [167.235.30.10]\n\nTASK [common : Restart sshd] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [168.119.165.118]\nchanged: [157.90.252.123]\nchanged: [168.119.101.156]\nchanged: [49.13.126.247]\nchanged: [65.109.2.124]\nchanged: [167.235.30.10]\n\nTASK [Allow incoming traffic on specified ports] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [157.90.252.123] =&gt; (item=6001)\nchanged: [168.119.165.118] =&gt; (item=6001)\nchanged: [49.13.126.247] =&gt; (item=6001)\nchanged: [65.109.2.124] =&gt; (item=6001)\nchanged: [168.119.101.156] =&gt; (item=6001)\nchanged: [167.235.30.10] =&gt; (item=6001)\n\nPLAY RECAP ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\n157.90.252.123             : ok=12   changed=11   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\n167.235.253.176            : ok=15   changed=12   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\n167.235.30.10              : ok=12   changed=11   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\n168.119.101.156            : ok=12   changed=11   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\n168.119.165.118            : ok=12   changed=11   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\n49.13.126.247              : ok=12   changed=11   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\n65.109.2.124               : ok=12   changed=11   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\n\n</code></pre>"},{"location":"terminal/db_ansible/","title":"Psql","text":"<pre><code>ansible-playbook playbooks/playbook_psql.yml\n\nPLAY [Install python and pip] *************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\n\nTASK [Gathering Facts] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [88.198.111.144]\n\nTASK [Install Python] *********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [88.198.111.144]\n\nTASK [Download get-pip.py script] *********************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [88.198.111.144]\n\nTASK [Install pip using get-pip.py] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [88.198.111.144]\n\nTASK [Install psycopg2-binary] ************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [88.198.111.144]\n\nPLAY [db] *********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\n\nTASK [Gathering Facts] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [88.198.111.144]\n\nTASK [common : Update package lists] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [88.198.111.144]\n\nTASK [common : Upgrade all packages] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [88.198.111.144]\n\nTASK [common : Install public AuthorizedKeysFile] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [88.198.111.144]\n\nTASK [common : Install required packages] *************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [88.198.111.144]\n\nTASK [common : Allow everything and enable UFW] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [88.198.111.144]\n\nTASK [common : Allow incoming traffic on specified ports] *********************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [88.198.111.144] =&gt; (item=22)\n\nTASK [common : Configure Fail2Ban] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [88.198.111.144]\n\nTASK [common : Restart fail2ban] **********************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [88.198.111.144]\n\nTASK [common : SSH Hardening for root user] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [88.198.111.144]\n\nTASK [common : Restart sshd] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [88.198.111.144]\n\nTASK [postgresql : include_vars] **********************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [88.198.111.144] =&gt; (item=/home/ujstor/code/ujstor/deployment-cluster-s3-psqldb/ansible/playbooks/roles/postgresql/vars/../vars/Debian_22.yml)\n\nTASK [postgresql : include_vars] **********************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [88.198.111.144] =&gt; (item=/home/ujstor/code/ujstor/deployment-cluster-s3-psqldb/ansible/playbooks/roles/postgresql/vars/../vars/postgresql_16.yml)\n\nTASK [postgresql : PostgreSQL | Make sure the CA certificates are available | apt] ********************************************************************************************************************************************************************************************************************************************************************************************************\nok: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Add PostgreSQL repository apt-key | apt] ******************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Add PostgreSQL repository | apt] **************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Add PostgreSQL repository preferences | apt] **************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Install PostgreSQL | apt] *********************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | PGTune | apt] *********************************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Install all the required dependencies (yum) | RHEL] *******************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Add PostgreSQL repository | RHEL] *************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Disable postgresql module (necessary for RHEL8+)] *********************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Install PostgreSQL | RHEL] ********************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Setup service users profile | RHEL] ***********************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Create ~/pgtab.example | RHEL] ****************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Create ~/pgtab header | RHEL] *****************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Create ~/pgtab Ansible warning | RHEL] ********************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Add database to ~/pgtab | RHEL] ***************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | PGTune | RHEL] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgrSQL | Install all the required dependencies | dnf] ***************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PIP install psycopg2-binary on Fedora 33 only if postgresql version &lt; 10] **********************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Add yum Repository | dnf] *********************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Install PostgreSQL | dnf] *********************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | PGTune | dnf] *********************************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Extensions | Make sure the postgres contrib extensions are installed | Debian] ****************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Extensions | Make sure the postgres contrib extensions are installed | RedHat] ****************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Extensions | Make sure the postgres contrib extensions are installed | Fedora] ****************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Extensions | Make sure the development headers are installed | Debian] ************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Extensions | Make sure the development headers are installed | RedHat] ************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Extensions | Make sure the development headers are installed | Fedora] ************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : include_vars] **********************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144] =&gt; (item=/home/ujstor/code/ujstor/deployment-cluster-s3-psqldb/ansible/playbooks/roles/postgresql/vars/../vars/jammy.yml)\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Extensions | Make sure the postgis extensions are installed | Debian] *************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Extensions | Make sure the postgis extensions are installed | RedHat] *************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Extensions | Make sure the postgis extensions are installed | Fedora] *************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : include_vars] **********************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Extensions | Add repo keys | apt] *************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Extensions | Add repos | apt] *****************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Extensions | Add repos | RHEL] ****************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Extensions | Add packages | apt] **************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Extensions | Add packages | RHEL] *************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | FDW | Load OS specific variables] *************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | FDW | MySQL] **********************************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | FDW | OGR] ************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Drop the data directory | RedHat] *************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Make sure the postgres data directory exists] *************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Make sure postgres tablespaces directories exist] *********************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Make sure the postgres WAL directory exists] **************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Make sure the postgres log directory exists] **************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Ensure the locale for lc_collate and lc_ctype is generated | Debian] **************************************************************************************************************************************************************************************************************************************************************************************\nok: [88.198.111.144] =&gt; (item=en_US.UTF-8)\nok: [88.198.111.144] =&gt; (item=en_US.UTF-8)\n\nTASK [postgresql : PostgreSQL | Ensure the locale is generated | RedHat] ******************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144] =&gt; (item={'parts': ['en_US', 'UTF-8'], 'locale_name': 'en_US.UTF-8'})\nskipping: [88.198.111.144] =&gt; (item={'parts': ['en_US', 'UTF-8'], 'locale_name': 'en_US.UTF-8'})\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Stop PostgreSQL | Debian] *********************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Reset the cluster - drop the existing one | Debian] *******************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Reset the cluster - create a new one (with specified encoding and locale) | Debian] ***********************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Update systemd | Debian] **********************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Start PostgreSQL | Debian] ********************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Check whether the postgres data directory is initialized | RedHat] ****************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Initialize the database | RedHat] *************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Verify postgresql cluster version] ************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Ensure configuration directory exists] ********************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Update configuration - pt. 1 (pg_hba.conf)] ***************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Update configuration - pt. 2 (postgresql.conf)] ***********************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Update configuration - pt. 3 (pgtune)] ********************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Update configuration - pt. 4 (pg_ident.conf)] *************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Create folder for additional configuration files] *********************************************************************************************************************************************************************************************************************************************************************************************************\nok: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Ensure the systemd directory for PostgreSQL exists | RedHat] **********************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Use the conf directory when starting the Postgres service | RedHat] ***************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Ensure the pid directory for PostgreSQL exists] ***********************************************************************************************************************************************************************************************************************************************************************************************************\nok: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Ensure PostgreSQL is running] *****************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Reload PostgreSQL configuration] **************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Ensure PostgreSQL is running] *****************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Make sure the PostgreSQL users are present] ***************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [88.198.111.144] =&gt; (item={'name': 'ujstor', 'pass': 'password1234', 'encrypted': True, 'state': 'present'})\n[WARNING]: Module remote_tmp /var/lib/postgresql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually\n\nTASK [postgresql : PostgreSQL | Ensure PostgreSQL is running] *****************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Make sure the PostgreSQL databases are present] ***********************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [88.198.111.144] =&gt; (item={'name': 'blueprint', 'owner': 'ujstor', 'state': 'present'})\n\nTASK [postgresql : PostgreSQL | Add extensions to the databases] **************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Add hstore to the databases with the requirement] *********************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144] =&gt; (item={'name': 'blueprint', 'owner': 'ujstor', 'state': 'present'})\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Add uuid-ossp to the database with the requirement] *******************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144] =&gt; (item={'name': 'blueprint', 'owner': 'ujstor', 'state': 'present'})\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Add postgis to the databases with the requirement] ********************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144] =&gt; (item={'name': 'blueprint', 'owner': 'ujstor', 'state': 'present'})\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | add cube to the database with the requirement] ************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144] =&gt; (item={'name': 'blueprint', 'owner': 'ujstor', 'state': 'present'})\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Add plpgsql to the database with the requirement] *********************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144] =&gt; (item={'name': 'blueprint', 'owner': 'ujstor', 'state': 'present'})\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | add earthdistance to the database with the requirement] ***************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144] =&gt; (item={'name': 'blueprint', 'owner': 'ujstor', 'state': 'present'})\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Add citext to the database with the requirement] **********************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144] =&gt; (item={'name': 'blueprint', 'owner': 'ujstor', 'state': 'present'})\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Add Schema to databases] **********************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [88.198.111.144] =&gt; (item={'database': 'blueprint', 'schema': 'ujstor-test', 'state': 'present'})\n\nTASK [postgresql : PostgreSQL | Update the user privileges] *******************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [88.198.111.144] =&gt; (item={'name': 'ujstor', 'db': 'blueprint', 'role_attr_flags': 'SUPERUSER'})\n\nTASK [postgresql : PostgreSQL | (Monit) Copy the postgresql monit service file] ***********************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Check binary version] *************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Check database version] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [88.198.111.144]\n\nTASK [postgresql : PostgreSQL | Verify binary and database versions match] ****************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [88.198.111.144]\n\nTASK [Allow DB Port] **********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [88.198.111.144]\n\nRUNNING HANDLER [postgresql : restart postgresql] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [88.198.111.144]\n\nPLAY RECAP ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\n88.198.111.144             : ok=46   changed=29   unreachable=0    failed=0    skipped=58   rescued=0    ignored=0\n\n\n</code></pre>"},{"location":"terminal/minio_ansible/","title":"MinIO","text":"<pre><code>ansible-playbook playbooks/playbook_minio.yml\n\nPLAY [Cluster config | ssl, dns, rename drives] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************\n\nTASK [Gathering Facts] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [159.69.241.156]\nok: [49.13.167.104]\nok: [91.107.198.134]\nok: [65.109.141.80]\n\nTASK [Check if cert directory exists] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [49.13.167.104]\nok: [159.69.241.156]\nok: [91.107.198.134]\nok: [65.109.141.80]\n\nTASK [Create cert directory] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [49.13.167.104]\nchanged: [91.107.198.134]\nchanged: [159.69.241.156]\nchanged: [65.109.141.80]\n\nTASK [Copy openssl crt] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [49.13.167.104]\nchanged: [159.69.241.156]\nchanged: [91.107.198.134]\nchanged: [65.109.141.80]\n\nTASK [Copy openssl crt to CAs] ************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [49.13.167.104]\nchanged: [159.69.241.156]\nchanged: [91.107.198.134]\nchanged: [65.109.141.80]\n\nTASK [Copy openssl key] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [159.69.241.156]\nchanged: [91.107.198.134]\nchanged: [49.13.167.104]\nchanged: [65.109.141.80]\n\nTASK [Configure DNS mappings] *************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [49.13.167.104] =&gt; (item={'hostname': 'minio1.ujstor.com', 'ip_address': '10.0.4.2'})\nchanged: [159.69.241.156] =&gt; (item={'hostname': 'minio1.ujstor.com', 'ip_address': '10.0.4.2'})\nchanged: [91.107.198.134] =&gt; (item={'hostname': 'minio1.ujstor.com', 'ip_address': '10.0.4.2'})\nchanged: [65.109.141.80] =&gt; (item={'hostname': 'minio1.ujstor.com', 'ip_address': '10.0.4.2'})\nchanged: [49.13.167.104] =&gt; (item={'hostname': 'minio2.ujstor.com', 'ip_address': '10.0.4.3'})\nchanged: [91.107.198.134] =&gt; (item={'hostname': 'minio2.ujstor.com', 'ip_address': '10.0.4.3'})\nchanged: [159.69.241.156] =&gt; (item={'hostname': 'minio2.ujstor.com', 'ip_address': '10.0.4.3'})\nchanged: [65.109.141.80] =&gt; (item={'hostname': 'minio2.ujstor.com', 'ip_address': '10.0.4.3'})\nchanged: [49.13.167.104] =&gt; (item={'hostname': 'minio3.ujstor.com', 'ip_address': '10.0.4.4'})\nchanged: [159.69.241.156] =&gt; (item={'hostname': 'minio3.ujstor.com', 'ip_address': '10.0.4.4'})\nchanged: [91.107.198.134] =&gt; (item={'hostname': 'minio3.ujstor.com', 'ip_address': '10.0.4.4'})\nchanged: [65.109.141.80] =&gt; (item={'hostname': 'minio3.ujstor.com', 'ip_address': '10.0.4.4'})\nchanged: [49.13.167.104] =&gt; (item={'hostname': 'minio4.ujstor.com', 'ip_address': '10.0.4.5'})\nchanged: [159.69.241.156] =&gt; (item={'hostname': 'minio4.ujstor.com', 'ip_address': '10.0.4.5'})\nchanged: [91.107.198.134] =&gt; (item={'hostname': 'minio4.ujstor.com', 'ip_address': '10.0.4.5'})\nchanged: [65.109.141.80] =&gt; (item={'hostname': 'minio4.ujstor.com', 'ip_address': '10.0.4.5'})\n\nTASK [Copy mount volume rename script] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [49.13.167.104]\nchanged: [91.107.198.134]\nchanged: [159.69.241.156]\nchanged: [65.109.141.80]\n\nTASK [Execute the script] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [49.13.167.104]\nchanged: [91.107.198.134]\nchanged: [159.69.241.156]\nchanged: [65.109.141.80]\n\nTASK [Reboot server] **********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nfatal: [49.13.167.104]: UNREACHABLE! =&gt; {\"changed\": false, \"msg\": \"Failed to connect to the host via ssh: Shared connection to 49.13.167.104 closed.\", \"unreachable\": true}\n...ignoring\nfatal: [91.107.198.134]: UNREACHABLE! =&gt; {\"changed\": false, \"msg\": \"Failed to connect to the host via ssh: Shared connection to 91.107.198.134 closed.\", \"unreachable\": true}\n...ignoring\nfatal: [159.69.241.156]: UNREACHABLE! =&gt; {\"changed\": false, \"msg\": \"Failed to connect to the host via ssh: Shared connection to 159.69.241.156 closed.\", \"unreachable\": true}\n...ignoring\nfatal: [65.109.141.80]: UNREACHABLE! =&gt; {\"changed\": false, \"msg\": \"Failed to connect to the host via ssh: Shared connection to 65.109.141.80 closed.\", \"unreachable\": true}\n...ignoring\n\nTASK [Wait for servers to come back online] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [49.13.167.104]\nok: [159.69.241.156]\nok: [91.107.198.134]\nok: [65.109.141.80]\n\nPLAY [Install minIO] **********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\n\nTASK [Gathering Facts] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [49.13.167.104]\nok: [91.107.198.134]\nok: [159.69.241.156]\nok: [65.109.141.80]\n\nTASK [common : Update package lists] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [91.107.198.134]\nchanged: [49.13.167.104]\nchanged: [159.69.241.156]\nchanged: [65.109.141.80]\n\nTASK [common : Upgrade all packages] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [49.13.167.104]\nchanged: [91.107.198.134]\nchanged: [159.69.241.156]\nchanged: [65.109.141.80]\n\nTASK [common : Install public AuthorizedKeysFile] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [159.69.241.156]\nchanged: [65.109.141.80]\nchanged: [91.107.198.134]\nchanged: [49.13.167.104]\n\nTASK [common : Install required packages] *************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [91.107.198.134]\nchanged: [159.69.241.156]\nchanged: [49.13.167.104]\nchanged: [65.109.141.80]\n\nTASK [common : Allow everything and enable UFW] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [91.107.198.134]\nchanged: [159.69.241.156]\nchanged: [49.13.167.104]\nchanged: [65.109.141.80]\n\nTASK [common : Allow incoming traffic on specified ports] *********************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [49.13.167.104] =&gt; (item=22)\nchanged: [159.69.241.156] =&gt; (item=22)\nchanged: [91.107.198.134] =&gt; (item=22)\nchanged: [65.109.141.80] =&gt; (item=22)\n\nTASK [common : Configure Fail2Ban] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [91.107.198.134]\nchanged: [159.69.241.156]\nchanged: [49.13.167.104]\nchanged: [65.109.141.80]\n\nTASK [common : Restart fail2ban] **********************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [91.107.198.134]\nchanged: [159.69.241.156]\nchanged: [49.13.167.104]\nchanged: [65.109.141.80]\n\nTASK [common : SSH Hardening for root user] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [49.13.167.104]\nchanged: [159.69.241.156]\nchanged: [91.107.198.134]\nchanged: [65.109.141.80]\n\nTASK [common : Restart sshd] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [49.13.167.104]\nchanged: [159.69.241.156]\nchanged: [91.107.198.134]\nchanged: [65.109.141.80]\n\nTASK [minio : Install server] *************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nincluded: /home/ujstor/code/ujstor/deployment-cluster-s3-psqldb/ansible/playbooks/roles/minio/tasks/install_server.yml for 91.107.198.134, 49.13.167.104, 65.109.141.80, 159.69.241.156\n\nTASK [minio : Compose the Minio server download url] **************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [91.107.198.134]\nok: [49.13.167.104]\nok: [65.109.141.80]\nok: [159.69.241.156]\n\nTASK [minio : Get the Minio server checksum for architecture amd64] ***********************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [65.109.141.80]\nok: [49.13.167.104]\nok: [91.107.198.134]\nok: [159.69.241.156]\n\nTASK [minio : Create Minio group] *********************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [49.13.167.104]\nchanged: [91.107.198.134]\nchanged: [159.69.241.156]\nchanged: [65.109.141.80]\n\nTASK [minio : Create Minio user] **********************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [49.13.167.104]\nchanged: [91.107.198.134]\nchanged: [159.69.241.156]\nchanged: [65.109.141.80]\n\nTASK [minio : Create the Minio config directories] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [159.69.241.156] =&gt; (item=/etc/minio)\nchanged: [49.13.167.104] =&gt; (item=/etc/minio)\nchanged: [91.107.198.134] =&gt; (item=/etc/minio)\nchanged: [65.109.141.80] =&gt; (item=/etc/minio)\nchanged: [159.69.241.156] =&gt; (item=/etc/minio/ssl)\nchanged: [49.13.167.104] =&gt; (item=/etc/minio/ssl)\nchanged: [91.107.198.134] =&gt; (item=/etc/minio/ssl)\nchanged: [65.109.141.80] =&gt; (item=/etc/minio/ssl)\nchanged: [159.69.241.156] =&gt; (item=/etc/minio/policy)\nchanged: [49.13.167.104] =&gt; (item=/etc/minio/policy)\nchanged: [91.107.198.134] =&gt; (item=/etc/minio/policy)\nchanged: [65.109.141.80] =&gt; (item=/etc/minio/policy)\n\nTASK [minio : Create the Minio data storage directories] **********************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [49.13.167.104] =&gt; (item=/var/lib/minio)\nchanged: [159.69.241.156] =&gt; (item=/var/lib/minio)\nchanged: [91.107.198.134] =&gt; (item=/var/lib/minio)\nchanged: [65.109.141.80] =&gt; (item=/var/lib/minio)\n\nTASK [minio : Download the Minio server] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [91.107.198.134]\nchanged: [49.13.167.104]\nchanged: [159.69.241.156]\nchanged: [65.109.141.80]\n\nTASK [minio : Generate the Minio server envfile] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [49.13.167.104]\nchanged: [159.69.241.156]\nchanged: [91.107.198.134]\nchanged: [65.109.141.80]\n\nTASK [minio : Create the Minio server systemd config] *************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [49.13.167.104]\nchanged: [159.69.241.156]\nchanged: [91.107.198.134]\nchanged: [65.109.141.80]\n\nTASK [minio : Copy SSL private key file] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [91.107.198.134]\nskipping: [49.13.167.104]\nskipping: [65.109.141.80]\nskipping: [159.69.241.156]\n\nTASK [minio : Copy cert file] *************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [91.107.198.134]\nskipping: [49.13.167.104]\nskipping: [65.109.141.80]\nskipping: [159.69.241.156]\n\nTASK [minio : Flush handlers] *************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\n\nTASK [minio : Flush handlers] *************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\n\nTASK [minio : Flush handlers] *************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\n\nTASK [minio : Flush handlers] *************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\n\nRUNNING HANDLER [minio : Reload minio systemd] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [49.13.167.104]\nok: [159.69.241.156]\nok: [91.107.198.134]\nok: [65.109.141.80]\n\nRUNNING HANDLER [minio : Restart minio] ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [49.13.167.104]\nchanged: [159.69.241.156]\nchanged: [91.107.198.134]\nchanged: [65.109.141.80]\n\nTASK [minio : Ensure minio is started at boot] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [49.13.167.104]\nchanged: [159.69.241.156]\nchanged: [91.107.198.134]\nchanged: [65.109.141.80]\n\nTASK [minio : Set secure minio url if not defined] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [91.107.198.134]\nskipping: [49.13.167.104]\nskipping: [65.109.141.80]\nskipping: [159.69.241.156]\n\nTASK [minio : Set unsecure minio_url if not defined] **************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [91.107.198.134]\nok: [49.13.167.104]\nok: [65.109.141.80]\nok: [159.69.241.156]\n\nTASK [minio : Install client] *************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nincluded: /home/ujstor/code/ujstor/deployment-cluster-s3-psqldb/ansible/playbooks/roles/minio/tasks/install_client.yml for 91.107.198.134, 49.13.167.104, 65.109.141.80, 159.69.241.156\n\nTASK [minio : Compose the Minio client download base url] *********************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [91.107.198.134]\nok: [49.13.167.104]\nok: [65.109.141.80]\nok: [159.69.241.156]\n\nTASK [minio : Get the Minio client checksum for architecture amd64] ***********************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [91.107.198.134]\nok: [49.13.167.104]\nok: [65.109.141.80]\nok: [159.69.241.156]\n\nTASK [minio : Download the Minio client] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [91.107.198.134]\nchanged: [49.13.167.104]\nchanged: [159.69.241.156]\nchanged: [65.109.141.80]\n\nTASK [minio : Configure server] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nincluded: /home/ujstor/code/ujstor/deployment-cluster-s3-psqldb/ansible/playbooks/roles/minio/tasks/configure_server.yml for 91.107.198.134\n\nTASK [minio : Set insecure mc command] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [91.107.198.134]\n\nTASK [minio : Set secure mc command] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [91.107.198.134]\n\nTASK [minio : Create Minio Users] *********************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [91.107.198.134]\n\nTASK [minio : Create Minio Buckets] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nincluded: /home/ujstor/code/ujstor/deployment-cluster-s3-psqldb/ansible/playbooks/roles/minio/tasks/create_minio_buckets.yml for 91.107.198.134\n\nTASK [minio : Ensure PIP is installed.] ***************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [91.107.198.134]\n\nTASK [minio : Install pip packages] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [91.107.198.134]\n\nTASK [minio : Create Buckets] *************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [91.107.198.134]\n\nTASK [minio : Create Prometheus bearer token] *********************************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [91.107.198.134]\n\nTASK [Allow http, UI and S3 API ports] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [91.107.198.134] =&gt; (item=9091)\nchanged: [49.13.167.104] =&gt; (item=9091)\nchanged: [159.69.241.156] =&gt; (item=9091)\nchanged: [65.109.141.80] =&gt; (item=9091)\nchanged: [91.107.198.134] =&gt; (item=9092)\nchanged: [49.13.167.104] =&gt; (item=9092)\nchanged: [159.69.241.156] =&gt; (item=9092)\nchanged: [65.109.141.80] =&gt; (item=9092)\n\nTASK [Reboot server1] *********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nfatal: [49.13.167.104]: UNREACHABLE! =&gt; {\"changed\": false, \"msg\": \"Failed to connect to the host via ssh: Shared connection to 49.13.167.104 closed.\", \"unreachable\": true}\n...ignoring\nfatal: [159.69.241.156]: UNREACHABLE! =&gt; {\"changed\": false, \"msg\": \"Failed to connect to the host via ssh: Shared connection to 159.69.241.156 closed.\", \"unreachable\": true}\n...ignoring\nfatal: [91.107.198.134]: UNREACHABLE! =&gt; {\"changed\": false, \"msg\": \"Failed to connect to the host via ssh: Shared connection to 91.107.198.134 closed.\", \"unreachable\": true}\n...ignoring\nfatal: [65.109.141.80]: UNREACHABLE! =&gt; {\"changed\": false, \"msg\": \"Failed to connect to the host via ssh: Shared connection to 65.109.141.80 closed.\", \"unreachable\": true}\n...ignoring\n\nTASK [Wait for servers to come back online1] **********************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [49.13.167.104]\nok: [159.69.241.156]\nok: [91.107.198.134]\nok: [65.109.141.80]\n\nTASK [Change ownership for /mnt/disk] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [91.107.198.134] =&gt; (item=/mnt/disk1)\nchanged: [159.69.241.156] =&gt; (item=/mnt/disk1)\nchanged: [49.13.167.104] =&gt; (item=/mnt/disk1)\nchanged: [65.109.141.80] =&gt; (item=/mnt/disk1)\nchanged: [49.13.167.104] =&gt; (item=/mnt/disk2)\nchanged: [159.69.241.156] =&gt; (item=/mnt/disk2)\nchanged: [91.107.198.134] =&gt; (item=/mnt/disk2)\nchanged: [65.109.141.80] =&gt; (item=/mnt/disk2)\nchanged: [49.13.167.104] =&gt; (item=/mnt/disk3)\nchanged: [159.69.241.156] =&gt; (item=/mnt/disk3)\nchanged: [91.107.198.134] =&gt; (item=/mnt/disk3)\nchanged: [65.109.141.80] =&gt; (item=/mnt/disk3)\nchanged: [49.13.167.104] =&gt; (item=/mnt/disk4)\nchanged: [91.107.198.134] =&gt; (item=/mnt/disk4)\nchanged: [159.69.241.156] =&gt; (item=/mnt/disk4)\nchanged: [65.109.141.80] =&gt; (item=/mnt/disk4)\n\nTASK [Reboot server2] *********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nfatal: [49.13.167.104]: UNREACHABLE! =&gt; {\"changed\": false, \"msg\": \"Failed to connect to the host via ssh: Shared connection to 49.13.167.104 closed.\", \"unreachable\": true}\n...ignoring\nfatal: [91.107.198.134]: UNREACHABLE! =&gt; {\"changed\": false, \"msg\": \"Failed to connect to the host via ssh: Shared connection to 91.107.198.134 closed.\", \"unreachable\": true}\n...ignoring\nfatal: [159.69.241.156]: UNREACHABLE! =&gt; {\"changed\": false, \"msg\": \"Failed to connect to the host via ssh: Shared connection to 159.69.241.156 closed.\", \"unreachable\": true}\n...ignoring\nfatal: [65.109.141.80]: UNREACHABLE! =&gt; {\"changed\": false, \"msg\": \"Failed to connect to the host via ssh: Shared connection to 65.109.141.80 closed.\", \"unreachable\": true}\n...ignoring\n\nTASK [Wait for servers to come back online2] **********************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [49.13.167.104]\nok: [91.107.198.134]\nok: [159.69.241.156]\nok: [65.109.141.80]\n\nPLAY RECAP ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\n159.69.241.156             : ok=46   changed=29   unreachable=0    failed=0    skipped=3    rescued=0    ignored=3\n49.13.167.104              : ok=46   changed=29   unreachable=0    failed=0    skipped=3    rescued=0    ignored=3\n65.109.141.80              : ok=46   changed=29   unreachable=0    failed=0    skipped=3    rescued=0    ignored=3\n91.107.198.134             : ok=51   changed=31   unreachable=0    failed=0    skipped=7    rescued=0    ignored=3\n\n\n\n</code></pre>"},{"location":"terminal/nginx_minio/","title":"Nginx minio","text":"<pre><code>ansible-playbook playbooks/playbook_nginx_minio_lb.yml\n\nPLAY [Configure Nginx as Load Balancer for MinIO cluster] *********************************************************************************************************************************************************************************************************************************************************************************************************************************\n\nTASK [Gathering Facts] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [157.90.150.92]\n\nTASK [common : Update package lists] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [157.90.150.92]\n\nTASK [common : Upgrade all packages] ******************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [157.90.150.92]\n\nTASK [common : Install public AuthorizedKeysFile] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [157.90.150.92]\n\nTASK [common : Install required packages] *************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [157.90.150.92]\n\nTASK [common : Allow everything and enable UFW] *******************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [157.90.150.92]\n\nTASK [common : Allow incoming traffic on specified ports] *********************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [157.90.150.92] =&gt; (item=22)\n\nTASK [common : Configure Fail2Ban] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [157.90.150.92]\n\nTASK [common : Restart fail2ban] **********************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [157.90.150.92]\n\nTASK [common : SSH Hardening for root user] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [157.90.150.92]\n\nTASK [common : Restart sshd] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [157.90.150.92]\n\nTASK [Install Nginx] **********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\n\nTASK [nginx : Include OS-specific variables.] *********************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [157.90.150.92]\n\nTASK [nginx : Define nginx_user.] *********************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [157.90.150.92]\n\nTASK [nginx : include_tasks] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [157.90.150.92]\n\nTASK [nginx : include_tasks] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nincluded: /home/ujstor/code/ujstor/deployment-cluster-s3-psqldb/ansible/playbooks/roles/nginx/tasks/setup-Ubuntu.yml for 157.90.150.92\n\nTASK [nginx : Ensure dirmngr is installed (gnupg dependency).] ****************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [157.90.150.92]\n\nTASK [nginx : Add PPA for Nginx (if configured).] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [157.90.150.92]\n\nTASK [nginx : Ensure nginx will reinstall if the PPA was just added.] *********************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [157.90.150.92]\n\nTASK [nginx : include_tasks] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nincluded: /home/ujstor/code/ujstor/deployment-cluster-s3-psqldb/ansible/playbooks/roles/nginx/tasks/setup-Debian.yml for 157.90.150.92\n\nTASK [nginx : Update apt cache.] **********************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [157.90.150.92]\n\nTASK [nginx : Ensure nginx is installed.] *************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [157.90.150.92]\n\nTASK [nginx : include_tasks] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [157.90.150.92]\n\nTASK [nginx : include_tasks] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [157.90.150.92]\n\nTASK [nginx : include_tasks] **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [157.90.150.92]\n\nTASK [nginx : Remove default nginx vhost config file (if configured).] ********************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [157.90.150.92]\n\nTASK [nginx : Ensure nginx_vhost_path exists.] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [157.90.150.92]\n\nTASK [nginx : Add managed vhost config files.] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [157.90.150.92]\n\nTASK [nginx : Remove managed vhost config files.] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************\nskipping: [157.90.150.92]\n\nTASK [nginx : Remove legacy vhosts.conf file.] ********************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [157.90.150.92]\n\nTASK [nginx : Copy nginx configuration in place.] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [157.90.150.92]\n\nTASK [nginx : Ensure nginx service is running as configured.] *****************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [157.90.150.92]\n\nTASK [Create NGINX configuration directory] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [157.90.150.92]\n\nTASK [Create nginx group] *****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [157.90.150.92]\n\nTASK [Create nginx system user] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nok: [157.90.150.92]\n\nTASK [Nginx configuration file] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [157.90.150.92]\n\nTASK [Allow http, UI and S3 API ports] ****************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [157.90.150.92] =&gt; (item=80)\nchanged: [157.90.150.92] =&gt; (item=443)\nchanged: [157.90.150.92] =&gt; (item=9091)\nchanged: [157.90.150.92] =&gt; (item=9092)\n\nRUNNING HANDLER [Restart Nginx] ***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************\nchanged: [157.90.150.92]\n\nPLAY RECAP ********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************\n157.90.150.92              : ok=28   changed=6    unreachable=0    failed=0    skipped=9    rescued=0    ignored=0\n\n</code></pre>"},{"location":"terminal/terraform/","title":"Terraform","text":"<pre><code>terraform apply\n\nTerraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols:\n  + create\n\nTerraform will perform the following actions:\n\n  # hcloud_network.network will be created\n  + resource \"hcloud_network\" \"network\" {\n      + delete_protection        = false\n      + expose_routes_to_vswitch = false\n      + id                       = (known after apply)\n      + ip_range                 = \"10.0.0.0/16\"\n      + name                     = \"network\"\n    }\n\n  # hcloud_network_subnet.db_subnet will be created\n  + resource \"hcloud_network_subnet\" \"db_subnet\" {\n      + gateway      = (known after apply)\n      + id           = (known after apply)\n      + ip_range     = \"10.0.3.0/24\"\n      + network_id   = (known after apply)\n      + network_zone = \"eu-central\"\n      + type         = \"cloud\"\n    }\n\n  # hcloud_network_subnet.deployment_subnet will be created\n  + resource \"hcloud_network_subnet\" \"deployment_subnet\" {\n      + gateway      = (known after apply)\n      + id           = (known after apply)\n      + ip_range     = \"10.0.1.0/24\"\n      + network_id   = (known after apply)\n      + network_zone = \"eu-central\"\n      + type         = \"cloud\"\n    }\n\n  # hcloud_network_subnet.minio_subnet will be created\n  + resource \"hcloud_network_subnet\" \"minio_subnet\" {\n      + gateway      = (known after apply)\n      + id           = (known after apply)\n      + ip_range     = \"10.0.4.0/24\"\n      + network_id   = (known after apply)\n      + network_zone = \"eu-central\"\n      + type         = \"cloud\"\n    }\n\n  # hcloud_network_subnet.services_subnet will be created\n  + resource \"hcloud_network_subnet\" \"services_subnet\" {\n      + gateway      = (known after apply)\n      + id           = (known after apply)\n      + ip_range     = \"10.0.2.0/24\"\n      + network_id   = (known after apply)\n      + network_zone = \"eu-central\"\n      + type         = \"cloud\"\n    }\n\n  # hcloud_server.coolify_controler[0] will be created\n  + resource \"hcloud_server\" \"coolify_controler\" {\n      + allow_deprecated_images    = false\n      + backup_window              = (known after apply)\n      + backups                    = false\n      + datacenter                 = (known after apply)\n      + delete_protection          = false\n      + firewall_ids               = (known after apply)\n      + id                         = (known after apply)\n      + ignore_remote_firewall_ids = false\n      + image                      = \"ubuntu-22.04\"\n      + ipv4_address               = (known after apply)\n      + ipv6_address               = (known after apply)\n      + ipv6_network               = (known after apply)\n      + keep_disk                  = false\n      + labels                     = {\n          + \"type\" = \"coolify-controler\"\n        }\n      + location                   = \"fsn1\"\n      + name                       = \"coolify-controler-0\"\n      + primary_disk_size          = (known after apply)\n      + rebuild_protection         = false\n      + server_type                = \"cx11\"\n      + shutdown_before_deletion   = false\n      + ssh_keys                   = (known after apply)\n      + status                     = (known after apply)\n    }\n\n  # hcloud_server.coolify_worker[0] will be created\n  + resource \"hcloud_server\" \"coolify_worker\" {\n      + allow_deprecated_images    = false\n      + backup_window              = (known after apply)\n      + backups                    = false\n      + datacenter                 = (known after apply)\n      + delete_protection          = false\n      + firewall_ids               = (known after apply)\n      + id                         = (known after apply)\n      + ignore_remote_firewall_ids = false\n      + image                      = \"ubuntu-22.04\"\n      + ipv4_address               = (known after apply)\n      + ipv6_address               = (known after apply)\n      + ipv6_network               = (known after apply)\n      + keep_disk                  = false\n      + labels                     = {\n          + \"type\" = \"coolify-worker\"\n        }\n      + location                   = \"fsn1\"\n      + name                       = \"coolify-worker-0\"\n      + primary_disk_size          = (known after apply)\n      + rebuild_protection         = false\n      + server_type                = \"cx21\"\n      + shutdown_before_deletion   = false\n      + ssh_keys                   = (known after apply)\n      + status                     = (known after apply)\n\n      + public_net {\n          + ipv4         = (known after apply)\n          + ipv4_enabled = true\n          + ipv6         = (known after apply)\n          + ipv6_enabled = true\n        }\n    }\n\n  # hcloud_server.coolify_worker[1] will be created\n  + resource \"hcloud_server\" \"coolify_worker\" {\n      + allow_deprecated_images    = false\n      + backup_window              = (known after apply)\n      + backups                    = false\n      + datacenter                 = (known after apply)\n      + delete_protection          = false\n      + firewall_ids               = (known after apply)\n      + id                         = (known after apply)\n      + ignore_remote_firewall_ids = false\n      + image                      = \"ubuntu-22.04\"\n      + ipv4_address               = (known after apply)\n      + ipv6_address               = (known after apply)\n      + ipv6_network               = (known after apply)\n      + keep_disk                  = false\n      + labels                     = {\n          + \"type\" = \"coolify-worker\"\n        }\n      + location                   = \"nbg1\"\n      + name                       = \"coolify-worker-1\"\n      + primary_disk_size          = (known after apply)\n      + rebuild_protection         = false\n      + server_type                = \"cx21\"\n      + shutdown_before_deletion   = false\n      + ssh_keys                   = (known after apply)\n      + status                     = (known after apply)\n\n      + public_net {\n          + ipv4         = (known after apply)\n          + ipv4_enabled = true\n          + ipv6         = (known after apply)\n          + ipv6_enabled = true\n        }\n    }\n\n  # hcloud_server.coolify_worker[2] will be created\n  + resource \"hcloud_server\" \"coolify_worker\" {\n      + allow_deprecated_images    = false\n      + backup_window              = (known after apply)\n      + backups                    = false\n      + datacenter                 = (known after apply)\n      + delete_protection          = false\n      + firewall_ids               = (known after apply)\n      + id                         = (known after apply)\n      + ignore_remote_firewall_ids = false\n      + image                      = \"ubuntu-22.04\"\n      + ipv4_address               = (known after apply)\n      + ipv6_address               = (known after apply)\n      + ipv6_network               = (known after apply)\n      + keep_disk                  = false\n      + labels                     = {\n          + \"type\" = \"coolify-worker\"\n        }\n      + location                   = \"hel1\"\n      + name                       = \"coolify-worker-2\"\n      + primary_disk_size          = (known after apply)\n      + rebuild_protection         = false\n      + server_type                = \"cx21\"\n      + shutdown_before_deletion   = false\n      + ssh_keys                   = (known after apply)\n      + status                     = (known after apply)\n\n      + public_net {\n          + ipv4         = (known after apply)\n          + ipv4_enabled = true\n          + ipv6         = (known after apply)\n          + ipv6_enabled = true\n        }\n    }\n\n  # hcloud_server.coolify_worker[3] will be created\n  + resource \"hcloud_server\" \"coolify_worker\" {\n      + allow_deprecated_images    = false\n      + backup_window              = (known after apply)\n      + backups                    = false\n      + datacenter                 = (known after apply)\n      + delete_protection          = false\n      + firewall_ids               = (known after apply)\n      + id                         = (known after apply)\n      + ignore_remote_firewall_ids = false\n      + image                      = \"ubuntu-22.04\"\n      + ipv4_address               = (known after apply)\n      + ipv6_address               = (known after apply)\n      + ipv6_network               = (known after apply)\n      + keep_disk                  = false\n      + labels                     = {\n          + \"type\" = \"coolify-worker\"\n        }\n      + location                   = \"fsn1\"\n      + name                       = \"coolify-worker-3\"\n      + primary_disk_size          = (known after apply)\n      + rebuild_protection         = false\n      + server_type                = \"cx21\"\n      + shutdown_before_deletion   = false\n      + ssh_keys                   = (known after apply)\n      + status                     = (known after apply)\n\n      + public_net {\n          + ipv4         = (known after apply)\n          + ipv4_enabled = true\n          + ipv6         = (known after apply)\n          + ipv6_enabled = true\n        }\n    }\n\n  # hcloud_server.minio[0] will be created\n  + resource \"hcloud_server\" \"minio\" {\n      + allow_deprecated_images    = false\n      + backup_window              = (known after apply)\n      + backups                    = false\n      + datacenter                 = (known after apply)\n      + delete_protection          = false\n      + firewall_ids               = (known after apply)\n      + id                         = (known after apply)\n      + ignore_remote_firewall_ids = false\n      + image                      = \"ubuntu-22.04\"\n      + ipv4_address               = (known after apply)\n      + ipv6_address               = (known after apply)\n      + ipv6_network               = (known after apply)\n      + keep_disk                  = false\n      + labels                     = {\n          + \"type\" = \"minio\"\n        }\n      + location                   = \"fsn1\"\n      + name                       = \"minio-0\"\n      + primary_disk_size          = (known after apply)\n      + rebuild_protection         = false\n      + server_type                = \"cx21\"\n      + shutdown_before_deletion   = false\n      + ssh_keys                   = (known after apply)\n      + status                     = (known after apply)\n\n      + public_net {\n          + ipv4         = (known after apply)\n          + ipv4_enabled = true\n          + ipv6         = (known after apply)\n          + ipv6_enabled = true\n        }\n    }\n\n  # hcloud_server.minio[1] will be created\n  + resource \"hcloud_server\" \"minio\" {\n      + allow_deprecated_images    = false\n      + backup_window              = (known after apply)\n      + backups                    = false\n      + datacenter                 = (known after apply)\n      + delete_protection          = false\n      + firewall_ids               = (known after apply)\n      + id                         = (known after apply)\n      + ignore_remote_firewall_ids = false\n      + image                      = \"ubuntu-22.04\"\n      + ipv4_address               = (known after apply)\n      + ipv6_address               = (known after apply)\n      + ipv6_network               = (known after apply)\n      + keep_disk                  = false\n      + labels                     = {\n          + \"type\" = \"minio\"\n        }\n      + location                   = \"nbg1\"\n      + name                       = \"minio-1\"\n      + primary_disk_size          = (known after apply)\n      + rebuild_protection         = false\n      + server_type                = \"cx21\"\n      + shutdown_before_deletion   = false\n      + ssh_keys                   = (known after apply)\n      + status                     = (known after apply)\n\n      + public_net {\n          + ipv4         = (known after apply)\n          + ipv4_enabled = true\n          + ipv6         = (known after apply)\n          + ipv6_enabled = true\n        }\n    }\n\n  # hcloud_server.minio[2] will be created\n  + resource \"hcloud_server\" \"minio\" {\n      + allow_deprecated_images    = false\n      + backup_window              = (known after apply)\n      + backups                    = false\n      + datacenter                 = (known after apply)\n      + delete_protection          = false\n      + firewall_ids               = (known after apply)\n      + id                         = (known after apply)\n      + ignore_remote_firewall_ids = false\n      + image                      = \"ubuntu-22.04\"\n      + ipv4_address               = (known after apply)\n      + ipv6_address               = (known after apply)\n      + ipv6_network               = (known after apply)\n      + keep_disk                  = false\n      + labels                     = {\n          + \"type\" = \"minio\"\n        }\n      + location                   = \"hel1\"\n      + name                       = \"minio-2\"\n      + primary_disk_size          = (known after apply)\n      + rebuild_protection         = false\n      + server_type                = \"cx21\"\n      + shutdown_before_deletion   = false\n      + ssh_keys                   = (known after apply)\n      + status                     = (known after apply)\n\n      + public_net {\n          + ipv4         = (known after apply)\n          + ipv4_enabled = true\n          + ipv6         = (known after apply)\n          + ipv6_enabled = true\n        }\n    }\n\n  # hcloud_server.minio[3] will be created\n  + resource \"hcloud_server\" \"minio\" {\n      + allow_deprecated_images    = false\n      + backup_window              = (known after apply)\n      + backups                    = false\n      + datacenter                 = (known after apply)\n      + delete_protection          = false\n      + firewall_ids               = (known after apply)\n      + id                         = (known after apply)\n      + ignore_remote_firewall_ids = false\n      + image                      = \"ubuntu-22.04\"\n      + ipv4_address               = (known after apply)\n      + ipv6_address               = (known after apply)\u251c\u2500\u2500 ansible/\n\u2502   \u251c\u2500\u2500 inventory/\n\u2502   \u2502   \u2514\u2500\u2500 hosts\n\u2502   \u251c\u2500\u2500 playbooks/\n\u2502   \u2502   \u251c\u2500\u2500 roles/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 common/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 coolify/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 minio/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 nginx/\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 postgresql/\n\u2502   \u2502   \u251c\u2500\u2500 unique_templates_config/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 coolify_lb/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 minio_lb/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 scripts/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 ssl/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 playbook_install_python.yml\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 playbook_minio_preconfig.yml\n\u2502   \u2502   \u251c\u2500\u2500 playbook_install_coolify.yml\n\u2502   \u2502   \u251c\u2500\u2500 playbook_minio.yml\n\u2502   \u2502   \u251c\u2500\u2500 playbook_nginx_coolify_lb.yml\n\u2502   \u2502   \u251c\u2500\u2500 playbook_nginx_minio_lb.yml\n\u2502   \u2502   \u2514\u2500\u2500 playbook_psql.yml\n\u2502   \u251c\u2500\u2500 ansible.cfg\n\u2502   \u2514\u2500\u2500 requirements.yml\n\u251c\u2500\u2500 terraform-hetzner/\n\u2502   \u251c\u2500\u2500 load_balancer.tf\n\u2502   \u251c\u2500\u2500 main.tf\n\u2502   \u251c\u2500\u2500 network.tf\n\u2502   \u251c\u2500\u2500 output.tf\n\u2502   \u251c\u2500\u2500 provider.tf\n\u2502   \u251c\u2500\u2500 ssh.tf\n\u2502   \u251c\u2500\u2500 terraform.tfstate\n\u2502   \u251c\u2500\u2500 terraform.tfstate.backup\n\u2502   \u2514\u2500\u2500 variables.tf\n\u251c\u2500\u2500 LICENSE\n\u2514\u2500\u2500 README.md\n      + ipv6_network               = (known after apply)\n      + keep_disk                  = false\n      + labels                     = {\n          + \"type\" = \"minio\"\n        }\n      + location                   = \"fsn1\"\n      + name                       = \"minio-3\"\n      + primary_disk_size          = (known after apply)\n      + rebuild_protection         = false\n      + server_type                = \"cx21\"\n      + shutdown_before_deletion   = false\n      + ssh_keys                   = (known after apply)\n      + status                     = (known after apply)\n\n      + public_net {\n          + ipv4         = (known after apply)\n          + ipv4_enabled = true\n          + ipv6         = (known after apply)\n          + ipv6_enabled = true\n        }\n    }\n\n  # hcloud_server.minio_lb[0] will be created\n  + resource \"hcloud_server\" \"minio_lb\" {\n      + allow_deprecated_images    = false\n      + backup_window              = (known after apply)\n      + backups                    = false\n      + datacenter                 = (known after apply)\n      + delete_protection          = false\n      + firewall_ids               = (known after apply)\n      + id                         = (known after apply)\n      + ignore_remote_firewall_ids = false\n      + image                      = \"ubuntu-22.04\"\n      + ipv4_address               = (known after apply)\n      + ipv6_address               = (known after apply)\n      + ipv6_network               = (known after apply)\n      + keep_disk                  = false\n      + labels                     = {\n          + \"type\" = \"minio-lb\"\n        }\n      + location                   = \"fsn1\"\n      + name                       = \"minio-lb-0\"\n      + primary_disk_size          = (known after apply)\n      + rebuild_protection         = false\n      + server_type                = \"cx21\"\n      + shutdown_before_deletion   = false\n      + ssh_keys                   = (known after apply)\n      + status                     = (known after apply)\n    }\n\n  # hcloud_server.nginx_lb[0] will be created\n  + resource \"hcloud_server\" \"nginx_lb\" {\n      + allow_deprecated_images    = false\n      + backup_window              = (known after apply)\n      + backups                    = false\n      + datacenter                 = (known after apply)\n      + delete_protection          = false\n      + firewall_ids               = (known after apply)\n      + id                         = (known after apply)\n      + ignore_remote_firewall_ids = false\n      + image                      = \"ubuntu-22.04\"\n      + ipv4_address               = (known after apply)\n      + ipv6_address               = (known after apply)\n      + ipv6_network               = (known after apply)\n      + keep_disk                  = false\n      + labels                     = {\n          + \"type\" = \"nginx-lb\"\n        }\n      + location                   = \"fsn1\"\n      + name                       = \"nginx-lb-0\"\n      + primary_disk_size          = (known after apply)\n      + rebuild_protection         = false\n      + server_type                = \"cx11\"\n      + shutdown_before_deletion   = false\n      + ssh_keys                   = (known after apply)\n      + status                     = (known after apply)\n    }\n\n  # hcloud_server.postgres_db[0] will be created\n  + resource \"hcloud_server\" \"postgres_db\" {\n      + allow_deprecated_images    = false\n      + backup_window              = (known after apply)\n      + backups                    = false\n      + datacenter                 = (known after apply)\n      + delete_protection          = false\n      + firewall_ids               = (known after apply)\n      + id                         = (known after apply)\n      + ignore_remote_firewall_ids = false\n      + image                      = \"ubuntu-22.04\"\n      + ipv4_address               = (known after apply)\n      + ipv6_address               = (known after apply)\n      + ipv6_network               = (known after apply)\n      + keep_disk                  = false\n      + labels                     = {\n          + \"type\" = \"db\"\n        }\n      + location                   = \"fsn1\"\n      + name                       = \"postgres-0\"\n      + primary_disk_size          = (known after apply)\n      + rebuild_protection         = false\n      + server_type                = \"cx41\"\n      + shutdown_before_deletion   = false\n      + ssh_keys                   = (known after apply)\n      + status                     = (known after apply)\n\n      + public_net {\n          + ipv4         = (known after apply)\n          + ipv4_enabled = true\n          + ipv6         = (known after apply)\n          + ipv6_enabled = true\n        }\n    }\n\n  # hcloud_server.services[0] will be created\n  + resource \"hcloud_server\" \"services\" {\n      + allow_deprecated_images    = false\n      + backup_window              = (known after apply)\n      + backups                    = false\n      + datacenter                 = (known after apply)\n      + delete_protection          = false\n      + firewall_ids               = (known after apply)\n      + id                         = (known after apply)\n      + ignore_remote_firewall_ids = false\n      + image                      = \"ubuntu-22.04\"\n      + ipv4_address               = (known after apply)\n      + ipv6_address               = (known after apply)\n      + ipv6_network               = (known after apply)\n      + keep_disk                  = false\n      + labels                     = {\n          + \"type\" = \"services\"\n        }\n      + location                   = \"fsn1\"\n      + name                       = \"services-0\"\n      + primary_disk_size          = (known after apply)\n      + rebuild_protection         = false\n      + server_type                = \"cx21\"\n      + shutdown_before_deletion   = false\n      + ssh_keys                   = (known after apply)\n      + status                     = (known after apply)\n\n      + public_net {\n          + ipv4         = (known after apply)\n          + ipv4_enabled = true\n          + ipv6         = (known after apply)\n          + ipv6_enabled = true\n        }\n    }\n\n  # hcloud_server.services[1] will be created\n  + resource \"hcloud_server\" \"services\" {\n      + allow_deprecated_images    = false\n      + backup_window              = (known after apply)\n      + backups                    = false\n      + datacenter                 = (known after apply)\n      + delete_protection          = false\n      + firewall_ids               = (known after apply)\n      + id                         = (known after apply)\n      + ignore_remote_firewall_ids = false\n      + image                      = \"ubuntu-22.04\"\n      + ipv4_address               = (known after apply)\n      + ipv6_address               = (known after apply)\n      + ipv6_network               = (known after apply)\n      + keep_disk                  = false\n      + labels                     = {\n          + \"type\" = \"services\"\n        }\n      + location                   = \"nbg1\"\n      + name                       = \"services-1\"\n      + primary_disk_size          = (known after apply)\n      + rebuild_protection         = false\n      + server_type                = \"cx21\"\n      + shutdown_before_deletion   = false\n      + ssh_keys                   = (known after apply)\n      + status                     = (known after apply)\n\n      + public_net {\n          + ipv4         = (known after apply)\n          + ipv4_enabled = true\n          + ipv6         = (known after apply)\n          + ipv6_enabled = true\n        }\n    }\n\n  # hcloud_server_network.db_subnet[0] will be created\n  + resource \"hcloud_server_network\" \"db_subnet\" {\n      + id          = (known after apply)\n      + ip          = \"10.0.3.2\"\n      + mac_address = (known after apply)\n      + server_id   = (known after apply)\n      + subnet_id   = (known after apply)\n    }\n\n  # hcloud_server_network.deployment_subnet_controler[0] will be created\n  + resource \"hcloud_server_network\" \"deployment_subnet_controler\" {\n      + id          = (known after apply)\n      + ip          = \"10.0.1.6\"\n      + mac_address = (known after apply)\n      + server_id   = (known after apply)\n      + subnet_id   = (known after apply)\n    }\n\n  # hcloud_server_network.deployment_subnet_lb[0] will be created\n  + resource \"hcloud_server_network\" \"deployment_subnet_lb\" {\n      + id          = (known after apply)\n      + ip          = \"10.0.1.7\"\n      + mac_address = (known after apply)\n      + server_id   = (known after apply)\n      + subnet_id   = (known after apply)\n    }\n\n  # hcloud_server_network.deployment_subnet_minio_lb[0] will be created\n  + resource \"hcloud_server_network\" \"deployment_subnet_minio_lb\" {\n      + id          = (known after apply)\n      + ip          = \"10.0.4.7\"\n      + mac_address = (known after apply)\n      + server_id   = (known after apply)\n      + subnet_id   = (known after apply)\n    }\n\n  # hcloud_server_network.deployment_subnet_worker[0] will be created\n  + resource \"hcloud_server_network\" \"deployment_subnet_worker\" {\n      + id          = (known after apply)\n      + ip          = \"10.0.1.2\"\n      + mac_address = (known after apply)\n      + server_id   = (known after apply)\n      + subnet_id   = (known after apply)\n    }\n\n  # hcloud_server_network.deployment_subnet_worker[1] will be created\n  + resource \"hcloud_server_network\" \"deployment_subnet_worker\" {\n      + id          = (known after apply)\n      + ip          = \"10.0.1.3\"\n      + mac_address = (known after apply)\n      + server_id   = (known after apply)\n      + subnet_id   = (known after apply)\n    }\n\n  # hcloud_server_network.deployment_subnet_worker[2] will be created\n  + resource \"hcloud_server_network\" \"deployment_subnet_worker\" {\n      + id          = (known after apply)\n      + ip          = \"10.0.1.4\"\n      + mac_address = (known after apply)\n      + server_id   = (known after apply)\n      + subnet_id   = (known after apply)\n    }\n\n  # hcloud_server_network.deployment_subnet_worker[3] will be created\n  + resource \"hcloud_server_network\" \"deployment_subnet_worker\" {\n      + id          = (known after apply)\n      + ip          = \"10.0.1.5\"\n      + mac_address = (known after apply)\n      + server_id   = (known after apply)\n      + subnet_id   = (known after apply)\n    }\n\n  # hcloud_server_network.minio_subnet[0] will be created\n  + resource \"hcloud_server_network\" \"minio_subnet\" {\n      + id          = (known after apply)\n      + ip          = \"10.0.4.2\"\n      + mac_address = (known after apply)\n      + server_id   = (known after apply)\n      + subnet_id   = (known after apply)\n    }\n\n  # hcloud_server_network.minio_subnet[1] will be created\n  + resource \"hcloud_server_network\" \"minio_subnet\" {\n      + id          = (known after apply)\n      + ip          = \"10.0.4.3\"\n      + mac_address = (known after apply)\n      + server_id   = (known after apply)\n      + subnet_id   = (known after apply)\n    }\n\n  # hcloud_server_network.minio_subnet[2] will be created\n  + resource \"hcloud_server_network\" \"minio_subnet\" {\n      + id          = (known after apply)\n      + ip          = \"10.0.4.4\"\n      + mac_address = (known after apply)\n      + server_id   = (known after apply)\n      + subnet_id   = (known after apply)\n    }\n\n  # hcloud_server_network.minio_subnet[3] will be created\n  + resource \"hcloud_server_network\" \"minio_subnet\" {\n      + id          = (known after apply)\n      + ip          = \"10.0.4.5\"\n      + mac_address = (known after apply)\n      + server_id   = (known after apply)\n      + subnet_id   = (known after apply)\n    }\n\n  # hcloud_server_network.services_subnet[0] will be created\n  + resource \"hcloud_server_network\" \"services_subnet\" {\n      + id          = (known after apply)\n      + ip          = \"10.0.2.2\"\n      + mac_address = (known after apply)\n      + server_id   = (known after apply)\n      + subnet_id   = (known after apply)\n    }\n\n  # hcloud_server_network.services_subnet[1] will be created\n  + resource \"hcloud_server_network\" \"services_subnet\" {\n      + id          = (known after apply)\n      + ip          = \"10.0.2.3\"\n      + mac_address = (known after apply)\n      + server_id   = (known after apply)\n      + subnet_id   = (known after apply)\n    }\n\n  # hcloud_ssh_key.default will be created\n  + resource \"hcloud_ssh_key\" \"default\" {\n      + fingerprint = (known after apply)\n      + id          = (known after apply)\n      + name        = \"hetzner_key\"\n      + public_key  = (known after apply)\n    }\n\n  # hcloud_volume.minio_volume[0] will be created\n  + resource \"hcloud_volume\" \"minio_volume\" {\n      + delete_protection = false\n      + format            = \"xfs\"\n      + id                = (known after apply)\n      + linux_device      = (known after apply)\n      + location          = \"fsn1\"\n      + name              = \"drive-1\"\n      + server_id         = (known after apply)\n      + size              = 10\n    }\n\n  # hcloud_volume.minio_volume[1] will be created\n  + resource \"hcloud_volume\" \"minio_volume\" {\n      + delete_protection = false\n      + format            = \"xfs\"\n      + id                = (known after apply)\n      + linux_device      = (known after apply)\n      + location          = \"nbg1\"\n      + name              = \"drive-2\"\n      + server_id         = (known after apply)\n      + size              = 10\n    }\n\n  # hcloud_volume.minio_volume[2] will be created\n  + resource \"hcloud_volume\" \"minio_volume\" {\n      + delete_protection = false\n      + format            = \"xfs\"\n      + id                = (known after apply)\n      + linux_device      = (known after apply)\n      + location          = \"hel1\"\n      + name              = \"drive-3\"\n      + server_id         = (known after apply)\n      + size              = 10\n    }\n\n  # hcloud_volume.minio_volume[3] will be created\n  + resource \"hcloud_volume\" \"minio_volume\" {\n      + delete_protection = false\n      + format            = \"xfs\"\n      + id                = (known after apply)\n      + linux_device      = (known after apply)\n      + location          = \"fsn1\"\n      + name              = \"drive-4\"\n      + server_id         = (known after apply)\n      + size              = 10\n    }\n\n  # hcloud_volume.minio_volume[4] will be created\n  + resource \"hcloud_volume\" \"minio_volume\" {\n      + delete_protection = false\n      + format            = \"xfs\"\n      + id                = (known after apply)\n      + linux_device      = (known after apply)\n      + location          = \"fsn1\"\n      + name              = \"drive-5\"\n      + server_id         = (known after apply)\n      + size              = 10\n    }\n\n  # hcloud_volume.minio_volume[5] will be created\n  + resource \"hcloud_volume\" \"minio_volume\" {\n      + delete_protection = false\n      + format            = \"xfs\"\n      + id                = (known after apply)\n      + linux_device      = (known after apply)\n      + location          = \"nbg1\"\n      + name              = \"drive-6\"\n      + server_id         = (known after apply)\n      + size              = 10\n    }\n\n  # hcloud_volume.minio_volume[6] will be created\n  + resource \"hcloud_volume\" \"minio_volume\" {\n      + delete_protection = false\n      + format            = \"xfs\"\n      + id                = (known after apply)\n      + linux_device      = (known after apply)\n      + location          = \"hel1\"\n      + name              = \"drive-7\"\n      + server_id         = (known after apply)\n      + size              = 10\n    }\n\n  # hcloud_volume.minio_volume[7] will be created\n  + resource \"hcloud_volume\" \"minio_volume\" {\n      + delete_protection = false\n      + format            = \"xfs\"\n      + id                = (known after apply)\n      + linux_device      = (known after apply)\n      + location          = \"fsn1\"\n      + name              = \"drive-8\"\n      + server_id         = (known after apply)\n      + size              = 10\n    }\n\n  # hcloud_volume.minio_volume[8] will be created\n  + resource \"hcloud_volume\" \"minio_volume\" {\n      + delete_protection = false\n      + format            = \"xfs\"\n      + id                = (known after apply)\n      + linux_device      = (known after apply)\n      + location          = \"fsn1\"\n      + name              = \"drive-9\"\n      + server_id         = (known after apply)\n      + size              = 10\n    }\n\n  # hcloud_volume.minio_volume[9] will be created\n  + resource \"hcloud_volume\" \"minio_volume\" {\n      + delete_protection = false\n      + format            = \"xfs\"\n      + id                = (known after apply)\n      + linux_device      = (known after apply)\n      + location          = \"nbg1\"\n      + name              = \"drive-10\"\n      + server_id         = (known after apply)\n      + size              = 10\n    }\n\n  # hcloud_volume.minio_volume[10] will be created\n  + resource \"hcloud_volume\" \"minio_volume\" {\n      + delete_protection = false\n      + format            = \"xfs\"\n      + id                = (known after apply)\n      + linux_device      = (known after apply)\n      + location          = \"hel1\"\n      + name              = \"drive-11\"\n      + server_id         = (known after apply)\n      + size              = 10\n    }\n\n  # hcloud_volume.minio_volume[11] will be created\n  + resource \"hcloud_volume\" \"minio_volume\" {\n      + delete_protection = false\n      + format            = \"xfs\"\n      + id                = (known after apply)\n      + linux_device      = (known after apply)\n      + location          = \"fsn1\"\n      + name              = \"drive-12\"\n      + server_id         = (known after apply)\n      + size              = 10\n    }\n\n  # hcloud_volume.minio_volume[12] will be created\n  + resource \"hcloud_volume\" \"minio_volume\" {\n      + delete_protection = false\n      + format            = \"xfs\"\n      + id                = (known after apply)\n      + linux_device      = (known after apply)\n      + location          = \"fsn1\"\n      + name              = \"drive-13\"\n      + server_id         = (known after apply)\n      + size              = 10\n    }\n\n  # hcloud_volume.minio_volume[13] will be created\n  + resource \"hcloud_volume\" \"minio_volume\" {\n      + delete_protection = false\n      + format            = \"xfs\"\n      + id                = (known after apply)\n      + linux_device      = (known after apply)\n      + location          = \"nbg1\"\n      + name              = \"drive-14\"\n      + server_id         = (known after apply)\n      + size              = 10\n    }\n\n  # hcloud_volume.minio_volume[14] will be created\n  + resource \"hcloud_volume\" \"minio_volume\" {\n      + delete_protection = false\n      + format            = \"xfs\"\n      + id                = (known after apply)\n      + linux_device      = (known after apply)\n      + location          = \"hel1\"\n      + name              = \"drive-15\"\n      + server_id         = (known after apply)\n      + size              = 10\n    }\n\n  # hcloud_volume.minio_volume[15] will be created\n  + resource \"hcloud_volume\" \"minio_volume\" {\n      + delete_protection = false\n      + format            = \"xfs\"\n      + id                = (known after apply)\n      + linux_device      = (known after apply)\n      + location          = \"fsn1\"\n      + name              = \"drive-16\"\n      + server_id         = (known after apply)\n      + size              = 10\n    }\n\n  # hcloud_volume_attachment.minio_vol_attachment[0] will be created\n  + resource \"hcloud_volume_attachment\" \"minio_vol_attachment\" {\n      + automount = true\n      + id        = (known after apply)\n      + server_id = (known after apply)\n      + volume_id = (known after apply)\n    }\n\n  # hcloud_volume_attachment.minio_vol_attachment[1] will be created\n  + resource \"hcloud_volume_attachment\" \"minio_vol_attachment\" {\n      + automount = true\n      + id        = (known after apply)\n      + server_id = (known after apply)\n      + volume_id = (known after apply)\n    }\n\n  # hcloud_volume_attachment.minio_vol_attachment[2] will be created\n  + resource \"hcloud_volume_attachment\" \"minio_vol_attachment\" {\n      + automount = true\n      + id        = (known after apply)\n      + server_id = (known after apply)\n      + volume_id = (known after apply)\n    }\n\n  # hcloud_volume_attachment.minio_vol_attachment[3] will be created\n  + resource \"hcloud_volume_attachment\" \"minio_vol_attachment\" {\n      + automount = true\n      + id        = (known after apply)\n      + server_id = (known after apply)\n      + volume_id = (known after apply)\n    }\n\n  # hcloud_volume_attachment.minio_vol_attachment[4] will be created\n  + resource \"hcloud_volume_attachment\" \"minio_vol_attachment\" {\n      + automount = true\n      + id        = (known after apply)\n      + server_id = (known after apply)\n      + volume_id = (known after apply)\n    }\n\n  # hcloud_volume_attachment.minio_vol_attachment[5] will be created\n  + resource \"hcloud_volume_attachment\" \"minio_vol_attachment\" {\n      + automount = true\n      + id        = (known after apply)\n      + server_id = (known after apply)\n      + volume_id = (known after apply)\n    }\n\n  # hcloud_volume_attachment.minio_vol_attachment[6] will be created\n  + resource \"hcloud_volume_attachment\" \"minio_vol_attachment\" {\n      + automount = true\n      + id        = (known after apply)\n      + server_id = (known after apply)\n      + volume_id = (known after apply)\n    }\n\n  # hcloud_volume_attachment.minio_vol_attachment[7] will be created\n  + resource \"hcloud_volume_attachment\" \"minio_vol_attachment\" {\n      + automount = true\n      + id        = (known after apply)\n      + server_id = (known after apply)\n      + volume_id = (known after apply)\n    }\n\n  # hcloud_volume_attachment.minio_vol_attachment[8] will be created\n  + resource \"hcloud_volume_attachment\" \"minio_vol_attachment\" {\n      + automount = true\n      + id        = (known after apply)\n      + server_id = (known after apply)\n      + volume_id = (known after apply)\n    }\n\n  # hcloud_volume_attachment.minio_vol_attachment[9] will be created\n  + resource \"hcloud_volume_attachment\" \"minio_vol_attachment\" {\n      + automount = true\n      + id        = (known after apply)\n      + server_id = (known after apply)\n      + volume_id = (known after apply)\n    }\n\n  # hcloud_volume_attachment.minio_vol_attachment[10] will be created\n  + resource \"hcloud_volume_attachment\" \"minio_vol_attachment\" {\n      + automount = true\n      + id        = (known after apply)\n      + server_id = (known after apply)\n      + volume_id = (known after apply)\n    }\n\n  # hcloud_volume_attachment.minio_vol_attachment[11] will be created\n  + resource \"hcloud_volume_attachment\" \"minio_vol_attachment\" {\n      + automount = true\n      + id        = (known after apply)\n      + server_id = (known after apply)\n      + volume_id = (known after apply)\n    }\n\n  # hcloud_volume_attachment.minio_vol_attachment[12] will be created\n  + resource \"hcloud_volume_attachment\" \"minio_vol_attachment\" {\n      + automount = true\n      + id        = (known after apply)\n      + server_id = (known after apply)\n      + volume_id = (known after apply)\n    }\n\n  # hcloud_volume_attachment.minio_vol_attachment[13] will be created\n  + resource \"hcloud_volume_attachment\" \"minio_vol_attachment\" {\n      + automount = true\n      + id        = (known after apply)\n      + server_id = (known after apply)\n      + volume_id = (known after apply)\n    }\n\n  # hcloud_volume_attachment.minio_vol_attachment[14] will be created\n  + resource \"hcloud_volume_attachment\" \"minio_vol_attachment\" {\n      + automount = true\n      + id        = (known after apply)\n      + server_id = (known after apply)\n      + volume_id = (known after apply)\n    }\n\n  # hcloud_volume_attachment.minio_vol_attachment[15] will be created\n  + resource \"hcloud_volume_attachment\" \"minio_vol_attachment\" {\n      + automount = true\n      + id        = (known after apply)\n      + server_id = (known after apply)\n      + volume_id = (known after apply)\n    }\n\n  # tls_private_key.ssh_key will be created\n  + resource \"tls_private_key\" \"ssh_key\" {\n      + algorithm                     = \"RSA\"\n      + ecdsa_curve                   = \"P224\"\n      + id                            = (known after apply)\n      + private_key_openssh           = (sensitive value)\n      + private_key_pem               = (sensitive value)\n      + private_key_pem_pkcs8         = (sensitive value)\n      + public_key_fingerprint_md5    = (known after apply)\n      + public_key_fingerprint_sha256 = (known after apply)\n      + public_key_openssh            = (known after apply)\n      + public_key_pem                = (known after apply)\n      + rsa_bits                      = 4096\n    }\n\nPlan: 67 to add, 0 to change, 0 to destroy.\n\nChanges to Outputs:\n  + public_key    = (known after apply)\n  + server_ips    = {\n      + coolify_controler = {\n          + coolify-controler-0 = (known after apply)\n        }\n      + coolify_worker    = {\n          + coolify-worker-0 = (known after apply)\n          + coolify-worker-1 = (known after apply)\n          + coolify-worker-2 = (known after apply)\n          + coolify-worker-3 = (known after apply)\n        }\n      + minio             = {\n          + minio-0 = (known after apply)\n          + minio-1 = (known after apply)\n          + minio-2 = (known after apply)\n          + minio-3 = (known after apply)\n        }\n      + minio_lb          = {\n          + minio-lb-0 = (known after apply)\n        }\n      + nginx_lb          = {\n          + nginx-lb-0 = (known after apply)\n        }\n      + postgres_db       = {\n          + postgres-0 = (known after apply)\n        }\n      + services          = {\n          + services-0 = (known after apply)\n          + services-1 = (known after apply)\n        }\n    }\n  + server_status = {\n      + coolify_controler = {\n          + coolify-controler-0 = (known after apply)\n        }\n      + coolify_worker    = {\n          + coolify-worker-0 = (known after apply)\n          + coolify-worker-1 = (known after apply)\n          + coolify-worker-2 = (known after apply)\n          + coolify-worker-3 = (known after apply)\n        }\n      + minio             = {\n          + minio-0 = (known after apply)\n          + minio-1 = (known after apply)\n          + minio-2 = (known after apply)\n          + minio-3 = (known after apply)\n        }\n      + minio_lb          = {\n          + minio-lb-0 = (known after apply)\n        }\n      + nginx_lb          = {\n          + nginx-lb-0 = (known after apply)\n        }\n      + postgres_db       = {\n          + postgres-0 = (known after apply)\n        }\n      + services          = {\n          + services-0 = (known after apply)\n          + services-1 = (known after apply)\n        }\n    }\n\nDo you want to perform these actions?\n  Terraform will perform the actions described above.\n  Only 'yes' will be accepted to approve.\n\n  Enter a value: yes\n\nhcloud_network.network: Creating...\ntls_private_key.ssh_key: Creating...\ntls_private_key.ssh_key: Creation complete after 1s [id=c35da5e74082be398b764cfc148bca63432177f7]\nhcloud_ssh_key.default: Creating...\nhcloud_ssh_key.default: Creation complete after 1s [id=20068431]\nhcloud_network.network: Creation complete after 2s [id=4021674]\nhcloud_network_subnet.deployment_subnet: Creating...\nhcloud_network_subnet.db_subnet: Creating...\nhcloud_network_subnet.minio_subnet: Creating...\nhcloud_network_subnet.services_subnet: Creating...\nhcloud_network_subnet.minio_subnet: Creation complete after 2s [id=4021674-10.0.4.0/24]\nhcloud_network_subnet.services_subnet: Creation complete after 2s [id=4021674-10.0.2.0/24]\nhcloud_network_subnet.db_subnet: Creation complete after 2s [id=4021674-10.0.3.0/24]\nhcloud_network_subnet.deployment_subnet: Creation complete after 3s [id=4021674-10.0.1.0/24]\nhcloud_server.coolify_controler[0]: Creating...\nhcloud_server.coolify_controler[0]: Still creating... [10s elapsed]\nhcloud_server.coolify_controler[0]: Provisioning with 'local-exec'...\nhcloud_server.coolify_controler[0] (local-exec): (output suppressed due to sensitive value in config)\nhcloud_server.coolify_controler[0]: Creation complete after 14s [id=44837567]\nhcloud_server_network.deployment_subnet_controler[0]: Creating...\nhcloud_server.coolify_worker[1]: Creating...\nhcloud_server.minio[2]: Creating...\nhcloud_server.services[1]: Creating...\nhcloud_server.postgres_db[0]: Creating...\nhcloud_server.services[0]: Creating...\nhcloud_server.coolify_worker[2]: Creating...\nhcloud_server.coolify_worker[3]: Creating...\nhcloud_server.minio[3]: Creating...\nhcloud_server.minio[0]: Creating...\nhcloud_server_network.deployment_subnet_controler[0]: Still creating... [10s elapsed]\nhcloud_server.minio[2]: Still creating... [10s elapsed]\nhcloud_server.coolify_worker[1]: Still creating... [10s elapsed]\nhcloud_server.postgres_db[0]: Still creating... [10s elapsed]\nhcloud_server.services[1]: Still creating... [10s elapsed]\nhcloud_server.services[0]: Still creating... [10s elapsed]\nhcloud_server.coolify_worker[3]: Still creating... [10s elapsed]\nhcloud_server.coolify_worker[2]: Still creating... [10s elapsed]\nhcloud_server.minio[3]: Still creating... [10s elapsed]\nhcloud_server.minio[0]: Still creating... [10s elapsed]\nhcloud_server.minio[2]: Creation complete after 12s [id=44837569]\nhcloud_server.minio[1]: Creating...\nhcloud_server.coolify_worker[2]: Creation complete after 14s [id=44837568]\nhcloud_server.coolify_worker[0]: Creating...\nhcloud_server.minio[0]: Creation complete after 14s [id=44837571]\nhcloud_server.coolify_worker[1]: Creation complete after 15s [id=44837570]\nhcloud_server.services[0]: Creation complete after 15s [id=44837573]\nhcloud_server.services[1]: Creation complete after 15s [id=44837575]\nhcloud_server_network.services_subnet[1]: Creating...\nhcloud_server_network.services_subnet[0]: Creating...\nhcloud_server.minio[3]: Creation complete after 15s [id=44837576]\nhcloud_server.coolify_worker[3]: Creation complete after 15s [id=44837572]\nhcloud_server.postgres_db[0]: Creation complete after 17s [id=44837574]\nhcloud_server_network.db_subnet[0]: Creating...\nhcloud_server_network.deployment_subnet_controler[0]: Creation complete after 18s [id=44837567-4021674]\nhcloud_server_network.services_subnet[1]: Creation complete after 4s [id=44837575-4021674]\nhcloud_server_network.db_subnet[0]: Creation complete after 3s [id=44837574-4021674]\nhcloud_server.minio[1]: Still creating... [10s elapsed]\nhcloud_server.coolify_worker[0]: Still creating... [10s elapsed]\nhcloud_server_network.services_subnet[0]: Still creating... [10s elapsed]\nhcloud_server.coolify_worker[0]: Creation complete after 12s [id=44837580]\nhcloud_server_network.deployment_subnet_worker[3]: Creating...\nhcloud_server_network.deployment_subnet_worker[0]: Creating...\nhcloud_server_network.deployment_subnet_worker[2]: Creating...\nhcloud_server_network.deployment_subnet_worker[1]: Creating...\nhcloud_server.nginx_lb[0]: Creating...\nhcloud_server.minio[1]: Creation complete after 15s [id=44837581]\nhcloud_server_network.minio_subnet[1]: Creating...\nhcloud_server_network.minio_subnet[3]: Creating...\nhcloud_server_network.minio_subnet[0]: Creating...\nhcloud_server.minio_lb[0]: Creating...\nhcloud_server_network.deployment_subnet_worker[3]: Creation complete after 2s [id=44837572-4021674]\nhcloud_server_network.minio_subnet[2]: Creating...\nhcloud_server_network.deployment_subnet_worker[1]: Creation complete after 3s [id=44837570-4021674]\nhcloud_volume.minio_volume[8]: Creating...\nhcloud_server_network.minio_subnet[1]: Creation complete after 4s [id=44837581-4021674]\nhcloud_volume.minio_volume[0]: Creating...\nhcloud_server_network.deployment_subnet_worker[2]: Creation complete after 6s [id=44837568-4021674]\nhcloud_volume.minio_volume[2]: Creating...\nhcloud_server_network.minio_subnet[0]: Creation complete after 5s [id=44837571-4021674]\nhcloud_volume.minio_volume[15]: Creating...\nhcloud_volume.minio_volume[8]: Creation complete after 5s [id=100486556]\nhcloud_volume.minio_volume[11]: Creating...\nhcloud_server_network.services_subnet[0]: Creation complete after 19s [id=44837573-4021674]\nhcloud_volume.minio_volume[14]: Creating...\nhcloud_server_network.minio_subnet[3]: Creation complete after 8s [id=44837576-4021674]\nhcloud_volume.minio_volume[1]: Creating...\nhcloud_server_network.deployment_subnet_worker[0]: Still creating... [10s elapsed]\nhcloud_server.nginx_lb[0]: Still creating... [10s elapsed]\nhcloud_server_network.minio_subnet[2]: Creation complete after 8s [id=44837569-4021674]\nhcloud_volume.minio_volume[6]: Creating...\nhcloud_server.nginx_lb[0]: Creation complete after 11s [id=44837584]\nhcloud_volume.minio_volume[4]: Creating...\nhcloud_server.minio_lb[0]: Still creating... [10s elapsed]\nhcloud_volume.minio_volume[0]: Creation complete after 6s [id=100486557]\nhcloud_volume.minio_volume[9]: Creating...\nhcloud_volume.minio_volume[15]: Creation complete after 6s [id=100486558]\nhcloud_volume.minio_volume[10]: Creating...\nhcloud_volume.minio_volume[2]: Creation complete after 8s [id=100486559]\nhcloud_volume.minio_volume[13]: Creating...\nhcloud_volume.minio_volume[14]: Creation complete after 6s [id=100486561]\nhcloud_volume.minio_volume[7]: Creating...\nhcloud_volume.minio_volume[11]: Creation complete after 6s [id=100486560]\nhcloud_volume.minio_volume[3]: Creating...\nhcloud_volume.minio_volume[1]: Creation complete after 5s [id=100486562]\nhcloud_volume.minio_volume[5]: Creating...\nhcloud_volume.minio_volume[6]: Creation complete after 6s [id=100486563]\nhcloud_volume.minio_volume[12]: Creating...\nhcloud_server_network.deployment_subnet_worker[0]: Creation complete after 16s [id=44837580-4021674]\nhcloud_server_network.deployment_subnet_lb[0]: Creating...\nhcloud_volume.minio_volume[4]: Creation complete after 5s [id=100486564]\nhcloud_volume.minio_volume[10]: Creation complete after 4s [id=100486566]\nhcloud_volume.minio_volume[9]: Creation complete after 7s [id=100486565]\nhcloud_server.minio_lb[0]: Creation complete after 17s [id=44837585]\nhcloud_server_network.deployment_subnet_minio_lb[0]: Creating...\nhcloud_volume.minio_volume[5]: Creation complete after 5s [id=100486569]\nhcloud_volume.minio_volume[13]: Creation complete after 6s [id=100486568]\nhcloud_volume.minio_volume[3]: Creation complete after 6s [id=100486570]\nhcloud_volume.minio_volume[7]: Creation complete after 6s [id=100486567]\nhcloud_server_network.deployment_subnet_minio_lb[0]: Creation complete after 4s [id=44837585-4021674]\nhcloud_volume.minio_volume[12]: Creation complete after 6s [id=100486571]\nhcloud_volume_attachment.minio_vol_attachment[4]: Creating...\nhcloud_volume_attachment.minio_vol_attachment[3]: Creating...\nhcloud_volume_attachment.minio_vol_attachment[14]: Creating...\nhcloud_volume_attachment.minio_vol_attachment[12]: Creating...\nhcloud_volume_attachment.minio_vol_attachment[15]: Creating...\nhcloud_volume_attachment.minio_vol_attachment[2]: Creating...\nhcloud_volume_attachment.minio_vol_attachment[7]: Creating...\nhcloud_volume_attachment.minio_vol_attachment[11]: Creating...\nhcloud_volume_attachment.minio_vol_attachment[5]: Creating...\nhcloud_server_network.deployment_subnet_lb[0]: Still creating... [10s elapsed]\nhcloud_server_network.deployment_subnet_lb[0]: Creation complete after 10s [id=44837584-4021674]\nhcloud_volume_attachment.minio_vol_attachment[9]: Creating...\nhcloud_volume_attachment.minio_vol_attachment[15]: Creation complete after 5s [id=100486558]\nhcloud_volume_attachment.minio_vol_attachment[0]: Creating...\nhcloud_volume_attachment.minio_vol_attachment[2]: Creation complete after 6s [id=100486559]\nhcloud_volume_attachment.minio_vol_attachment[8]: Creating...\nhcloud_volume_attachment.minio_vol_attachment[5]: Creation complete after 6s [id=100486569]\nhcloud_volume_attachment.minio_vol_attachment[1]: Creating...\nhcloud_volume_attachment.minio_vol_attachment[11]: Creation complete after 6s [id=100486560]\nhcloud_volume_attachment.minio_vol_attachment[13]: Creating...\nhcloud_volume_attachment.minio_vol_attachment[3]: Creation complete after 6s [id=100486570]\nhcloud_volume_attachment.minio_vol_attachment[6]: Creating...\nhcloud_volume_attachment.minio_vol_attachment[12]: Creation complete after 7s [id=100486571]\nhcloud_volume_attachment.minio_vol_attachment[10]: Creating...\nhcloud_volume_attachment.minio_vol_attachment[4]: Creation complete after 7s [id=100486564]\nhcloud_volume_attachment.minio_vol_attachment[7]: Creation complete after 7s [id=100486567]\nhcloud_volume_attachment.minio_vol_attachment[14]: Creation complete after 8s [id=100486561]\nhcloud_volume_attachment.minio_vol_attachment[9]: Creation complete after 5s [id=100486565]\nhcloud_volume_attachment.minio_vol_attachment[1]: Creation complete after 6s [id=100486562]\nhcloud_volume_attachment.minio_vol_attachment[0]: Creation complete after 7s [id=100486557]\nhcloud_volume_attachment.minio_vol_attachment[13]: Creation complete after 6s [id=100486568]\nhcloud_volume_attachment.minio_vol_attachment[8]: Creation complete after 7s [id=100486556]\nhcloud_volume_attachment.minio_vol_attachment[10]: Creation complete after 6s [id=100486566]\nhcloud_volume_attachment.minio_vol_attachment[6]: Creation complete after 8s [id=100486563]\n\nApply complete! Resources: 67 added, 0 changed, 0 destroyed.\n\nOutputs:\n\npublic_key = &lt;&lt;EOT\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDlAV3wdrgSxQNCu8dCCY2NeW/DHIlpgYGoyNXD+YqG+yS2KM1ntmPqZFmXXw3risZclq9e5f++4jpqcdWKCaiIITx52Kzk6/MVj9e+UaYgPvsyBGhM7/tzXaZz8kOz0YkGboDwpjY7oWjl2va02/JOK/nVYdFZ7lfZiUejux/pQkN8xJAiI7x/72cr3GAaOB6ySQ1U3nfR7eypyCoJyzS0VfXLc3ONJ82RpUppE1WncFJokFgTagO3qhF3eMiGxrR5L7D/EV15QTkRtdKsckeNpK0t3ZjBGE1xzeBkw4yNEwhN/JcU/+zVT54McksTlY7BJnLOUqdFE0LM0fVFXbNU3EUvIf+yHewi41LuHxY5TSkK4CDZomNG5ECafjreD+ztzSfaNoIQ3UpQBMbzvZEUMXzezUCDHXEdC+5f5xdUp83URt9dRQ1zuuCnqbfFcasVyCif6uL/DJTgU+PytflBGDldk5THvAZz3G6oCBtR03N0cZajh3xtaNmpAAYCzsMEAnIw2v9EVs/JNJJrZSOjTK2n82xev+4563o5GQrZNCRh2X3WXuIhl4ERkYiLcRwniOxiXJJ15zvvgQXjsHx8lZUiew07F/FoQqnUBQVMFzYL2YQaBUNZLWnBFE1eNlOpCZCj3RqFeeKg0V9ZTtLEQBOmRXg09DdPWUkf/Jc02Q==\n\nEOT\nserver_ips = {\n  \"coolify_controler\" = {\n    \"coolify-controler-0\" = \"167.235.253.176\"\n  }\n  \"coolify_worker\" = {\n    \"coolify-worker-0\" = \"157.90.252.123\"\n    \"coolify-worker-1\" = \"168.119.165.118\"\n    \"coolify-worker-2\" = \"65.109.2.124\"\n    \"coolify-worker-3\" = \"49.13.126.247\"\n  }\n  \"minio\" = {\n    \"minio-0\" = \"91.107.198.134\"\n    \"minio-1\" = \"49.13.167.104\"\n    \"minio-2\" = \"65.109.141.80\"\n    \"minio-3\" = \"159.69.241.156\"\n  }\n  \"minio_lb\" = {\n    \"minio-lb-0\" = \"157.90.150.92\"\n  }\n  \"nginx_lb\" = {\n    \"nginx-lb-0\" = \"167.235.243.221\"\n  }\n  \"postgres_db\" = {\n    \"postgres-0\" = \"88.198.111.144\"\n  }\n  \"services\" = {\n    \"services-0\" = \"168.119.101.156\"\n    \"services-1\" = \"167.235.30.10\"\n  }\n}\nserver_status = {\n  \"coolify_controler\" = {\n    \"coolify-controler-0\" = \"running\"\n  }\n  \"coolify_worker\" = {\n    \"coolify-worker-0\" = \"running\"\n    \"coolify-worker-1\" = \"running\"\n    \"coolify-worker-2\" = \"running\"\n    \"coolify-worker-3\" = \"running\"\n  }\n  \"minio\" = {\n    \"minio-0\" = \"running\"\n    \"minio-1\" = \"running\"\n    \"minio-2\" = \"running\"\n    \"minio-3\" = \"running\"\n  }\n  \"minio_lb\" = {\n    \"minio-lb-0\" = \"running\"\n  }\n  \"nginx_lb\" = {\n    \"nginx-lb-0\" = \"running\"\n  }\n  \"postgres_db\" = {\n    \"postgres-0\" = \"running\"\n  }\n  \"services\" = {\n    \"services-0\" = \"running\"\n    \"services-1\" = \"running\"\n  }\n}\n</code></pre>"}]}